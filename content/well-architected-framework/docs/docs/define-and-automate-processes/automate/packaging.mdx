---
page_title: Package applications with containers and machine images
description: Learn how to package applications using containers and machine images. Automate builds with Packer for consistent deployments across all environments.
---

# Package applications with containers and machine images

Package your applications into containers and machine images to achieve consistent deployments across your environments. You can use Packer automate the creation of both container images and immutable machine images for AWS, Azure, or GCP. With Packer, you can define your packaging process as code, ensuring repeatable and reliable builds.

It is important to be familiar with what a Packer template is. A Packer template is a configuration file that defines how Packer should build a machine image or container. The main components of a Packer template include:

- **Source:** The base image to start from such as Ubuntu or Amazon Linux.
- **Builders:** The platform where you build the image including AWS, Azure, GCP, or Docker.
- **Provisioners:** Configuration steps like installing software, copying files, or running scripts.
- **Post-processors:** Actions after building, such as tagging images or pushing to a registry.

## Container packaging

Containers provide a consistent runtime environment that works across different infrastructure. Use Docker to package your applications with their dependencies, creating portable images that can run anywhere containers are supported.

Container images should be built from minimal base images and follow security best practices. Include only the necessary dependencies and use multi-stage builds to reduce image size. Tag your images with semantic versions and build hashes for traceability.

### Use Packer for container image builds

Packer automates Docker container image creation with consistent, repeatable builds using templates.

When you use Packer to create your container images, you gain the following benefits:

- Standardize container builds across your organization with reusable templates
- Build identical images across multiple container registries simultaneously
- Integrate with CI/CD pipelines for automated image creation
- Apply consistent security scanning and testing to all container images
- Version control your image configurations as code

The following is a basic example of a Packer template that builds a Docker container image:

```hcl

packer {
  required_plugins {
    docker = {
      version = ">= 1.0.8"
      source = "github.com/hashicorp/docker"
    }
  }
}

source "docker" "ubuntu" {
  image  = "ubuntu:jammy"
  commit = true
}

build {
  name    = "learn-packer"
  sources = [
    "source.docker.ubuntu"
  ]
}
```

To learn more about what this template does and how to run it, visit the [Packer Docker get started - build a container image tutorial](/packer/tutorials/docker-get-started/docker-get-started-build-image).

## Machine image packaging

For virtual machine deployments, package your application directly into the machine image using tools like Packer. This immutable infrastructure approach ensures that your application and its dependencies are baked into the image, eliminating configuration drift and deployment inconsistencies.

Machine images should include your application, runtime dependencies, and any required system configuration. Use automation to build these images consistently and test them before deployment.

### Use Packer for machine image builds
 
Packer automates machine image creation across multiple platforms including AWS, Azure, and GCP using templates.

When you use Packer to create your machine images, you gain the following benefits:

- Create identical machine images for multiple cloud providers from a single template
- Automate image provisioning with shell scripts, Ansible, Chef, or other configuration tools
- Build images in parallel to reduce build time
- Integrate with CI/CD pipelines for automated image creation
- Version control your image configurations as code

The following is a basic example of a Packer template that builds an AWS AMI:

```hcl
packer {
  required_plugins {
    amazon = {
      version = ">= 1.2.8"
      source  = "github.com/hashicorp/amazon"
    }
  }
}

source "amazon-ebs" "ubuntu" {
  ami_name      = "learn-packer-linux-aws"
  instance_type = "t2.micro"
  region        = "us-west-2"
  source_ami_filter {
    filters = {
      name                = "ubuntu/images/*ubuntu-jammy-22.04-amd64-server-*"
      root-device-type    = "ebs"
      virtualization-type = "hvm"
    }
    most_recent = true
    owners      = ["099720109477"]
  }
  ssh_username = "ubuntu"
}

build {
  name    = "learn-packer"
  sources = [
    "source.amazon-ebs.ubuntu"
  ]
}
```

To learn more about what this template does and how to run it, visit the [Packer AWS get started - build an image tutorial](/packer/tutorials/aws-get-started/aws-get-started-build-image).


HashiCorp resources:

- [Packer documentation](/packer/docs)
- [Packer tutorials](/packer/tutorials)
- [HCL templates overview](/packer/docs/templates/hcl_templates)
- [Packer Docker builder documentation](packer/plugins/builders/docker)
- [Build a Docker image with Packer](/packer/tutorials/docker-get-started)
- Build an image in [AWS](/packer/tutorials/aws-get-started), [Azure](/packer/tutorials/azure-get-started), or [GCP](/packer/tutorials/gcp-get-started)
- [Build a golden image pipeline with HCP Packer](/packer/tutorials/cloud-production/golden-image-with-hcp-packer)

External resources:

- [Learn container building best practices.](https://docs.docker.com/build/building/best-practices/)

## Next steps

In this section of Automate your workflows, you learned how to package applications for different deployment targets, such as containers and machine images. Packaging is part of the [Define and automate processes pillar](/well-architected-framework/define-and-automate-processes).

Visit the following documents to learn more about the automation workflow:

- [Deploy your packaged applications](/well-architected-framework/define-and-automate-processes/automate/deployments)
- [Test your packaged applications before deployment](/well-architected-framework/define-and-automate-processes/automate/testing)