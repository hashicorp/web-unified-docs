---
page_title: Package applications with containers and machine images
description: Learn how to package applications using containers and machine images. Automate builds with Packer for consistent deployments across all environments.
---

# Package applications with containers and machine images

Application packaging failures create deployment inconsistencies, security vulnerabilities, and operational overhead. When teams manually configure applications or use inconsistent build processes, each environment can drift from the intended state, causing deployment failures in production that are difficult to reproduce in development. Package your applications into containers and machine images to reduce these risks and achieve consistent, reproducible deployments across all environments.

You can use Packer to automate the creation of both container images and immutable machine images for AWS, Azure, or GCP. With Packer, you define your packaging process as code, ensuring repeatable and reliable builds every time.

## Why package applications

Packaging applications addresses the following operational and security challenges:

- **Eliminate configuration drift:** Manual configuration steps introduce inconsistencies between environments. Each deployment becomes a potential source of errors when developers must remember and repeat the same setup steps. Packaging captures your entire application configuration, dependencies, and runtime in a single artifact that deploys identically everywhere.

- **Reduce deployment time and risk:** Teams that build applications at deployment time face longer deployment windows and increased failure rates. Pre-built packages deploy faster and more reliably because the build and test phases happen before deployment, not during it.

- **Improve security posture:** Packaging enables you to scan, test, and approve application artifacts before they reach production. You can enforce security policies at build time, ensuring only verified packages deploy to your infrastructure.
- **Enable reproducibility:** When deployments fail, packaged applications let you quickly identify whether the issue stems from the application artifact or the deployment process. You can test the exact same package locally that failed in production, eliminating variables.

## Container packaging

Use containers when you need runtime isolation, want to deploy to Kubernetes, Nomad, or other container orchestrators, or manage applications across different operating systems or cloud providers. Containers package your applications with their dependencies into portable images that provide consistent runtime environments.

Build container images from minimal base images and follow security best practices. Include only the necessary dependencies and use multi-stage builds to reduce image size. Tag your images with semantic versions and build hashes for traceability.

### Use Packer for container image builds

Packer automates Docker container image creation with consistent, repeatable builds using templates.

When you use Packer to create your container images, you gain the following benefits:

- Standardize container builds across your organization with reusable templates, reducing build configuration errors and onboarding time for new team members
- Build identical images across multiple container registries simultaneously, enabling multi-cloud deployments without custom scripts
- Integrate with CI/CD pipelines for automated image creation, catching build failures before they reach production
- Apply consistent security scanning and testing to all container images, enforcing your security policies at build time
- Version control your image configurations as code, enabling audit trails and rollback capabilities

The following is a basic example of a Packer template that builds a Docker container image:

```hcl
packer {
  required_plugins {
    docker = {
      version = ">= 1.0.8"
      source = "github.com/hashicorp/docker"
    }
  }
}

source "docker" "ubuntu" {
  image  = "ubuntu:jammy"
  commit = true
}

build {
  name    = "learn-packer"
  sources = [
    "source.docker.ubuntu"
  ]
}
```

To learn more about what this template does and how to run it, visit the [Packer Docker get started - build a container image tutorial](/packer/tutorials/docker-get-started/docker-get-started-build-image).

## Machine image packaging

Machine images solve configuration drift and startup time challenges for virtual machine deployments. Use machine images when you need immutable infrastructure, want to minimize startup time by pre-installing dependencies, or deploy to environments where containers are not suitable or available.

For virtual machine deployments, package your application directly into the machine image using Packer. This immutable infrastructure approach ensures that your application and its dependencies are baked into the image, eliminating configuration drift and deployment inconsistencies.

Include your application, runtime dependencies, and any required system configuration in machine images. Use automation to build these images consistently and test them before deployment.

### Use Packer for machine image builds
 
Packer automates machine image creation across multiple platforms including AWS, Azure, and GCP using templates.

When you use Packer to create your machine images, you gain the following benefits:

- Create identical machine images for multiple cloud providers from a single template, eliminating platform-specific build scripts
- Automate image provisioning with shell scripts, Ansible, Chef, or other configuration tools, reducing manual configuration errors
- Build images in parallel to reduce build time, accelerating your release cycles
- Integrate with CI/CD pipelines for automated image creation, catching build failures before they reach production
- Version control your image configurations as code, enabling audit trails and rollback capabilities

The following is a basic example of a Packer template that builds an AWS AMI:

```hcl
packer {
  required_plugins {
    amazon = {
      version = ">= 1.2.8"
      source  = "github.com/hashicorp/amazon"
    }
  }
}

source "amazon-ebs" "ubuntu" {
  ami_name      = "learn-packer-linux-aws"
  instance_type = "t2.micro"
  region        = "us-west-2"
  source_ami_filter {
    filters = {
      name                = "ubuntu/images/*ubuntu-jammy-22.04-amd64-server-*"
      root-device-type    = "ebs"
      virtualization-type = "hvm"
    }
    most_recent = true
    owners      = ["099720109477"]
  }
  ssh_username = "ubuntu"
}

build {
  name    = "learn-packer"
  sources = [
    "source.amazon-ebs.ubuntu"
  ]
}
```

To learn more about what this template does and how to run it, visit the [Packer AWS get started - build an image tutorial](/packer/tutorials/aws-get-started/aws-get-started-build-image).


HashiCorp resources:

- Packer [documentation](/packer/docs)
- Packer [tutorials](/packer/tutorials)
- HCL templates [overview](/packer/docs/templates/hcl_templates)
- Packer Docker [builder documentation](/packer/plugins/builders/docker)
- [Build a Docker image with Packer](/packer/tutorials/docker-get-started)
- Build an image in [AWS](/packer/tutorials/aws-get-started), [Azure](/packer/tutorials/azure-get-started), or [GCP](/packer/tutorials/gcp-get-started)
- [Build a golden image pipeline with HCP Packer](/packer/tutorials/cloud-production/golden-image-with-hcp-packer)
- Configure machine images with shell scripts, Ansible, or Chef with Packer [provisioners ](/packer/docs/provisioners)


External resources:

- Learn [container building best practices.](https://docs.docker.com/build/building/best-practices/)

## Next steps

In this section of Automate your workflows, you learned how to package applications for different deployment targets, such as containers and machine images. Packaging is part of the [Define and automate processes pillar](/well-architected-framework/define-and-automate-processes).

Visit the following documents to learn more about the automation workflow:

- [Deploy your packaged applications](/well-architected-framework/define-and-automate-processes/automate/deployments)
- [Test your packaged applications before deployment](/well-architected-framework/define-and-automate-processes/automate/testing)