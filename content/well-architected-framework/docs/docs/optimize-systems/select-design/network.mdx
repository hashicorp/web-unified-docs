---
page_title: 
description: Learn how to design, load test, stress test, and scale your network.
---

# Design your network

The network that connects your services and its performance is critical to ensuring your applications run quickly and smoothly. As your application gains more users, sends more traffic, and adds more backend services, the load on your network can quickly grow. A well-designed network aims to distribute traffic to minimize latency and maximize performance.
## Plan for your known capacity

To plan for your network capacity, you must know what your network traffic looks like first. You should ask yourself questions like the following:

- How many concurrent connections will this network serve?
- How many requests will each connection make on average?
- What do those requests look like? Do they send or receive a lot of data at once?
- Are there known times that traffic will spike, and other times where it will slow down?
- How does scaling this application affect the network?
- How does scaling the network affect cost?
- Where are the connections coming from? Does this application serve users in a small local location or are users distributed globally?

Thinking of these kinds of questions early helps you plan both the initial design of your network, as well as how to respond to growing needs in the future.

Like you load and stress test your compute infrastructure to find bottlenecks in CPU and memory usage, you can perform similar tests on your network. By simulating expected, normal usage on your network, you can identify the key metrics to monitor and use to determine when to scale your infrastructure. Some of these common metrics include the following:

- Total bandwidth 
- Connection or user count
- Requests per second
- Latency

Once you understand the load on your network under normal use, stress tests can help identify where your network breaks under sudden extreme workloads. By testing these high demand situations, you can verify that your plan to scale responds to these needs correctly. 

## Design to meet demand

Demand on your infrastructure and network can change frequently and suddenly. Many factors can affect the number of people using your application, such as time of day, time of year, holidays, and special events. For example, an online store faces a much higher demand on their infrastructure during a holiday sale than they normally do. By understanding your traffic patterns, you can preemptively provision and scale additional infrastructure to prepare for the increased traffic. 

Load balancers help spread the load across your application and network evenly, and let you automatically react to issues in case part of a network becomes unavailable. Different load balancers have different strategies to distribute traffic, so refer to your cloud provider documentation to learn more.

Content Delivery Networks (CDNs) cache data that rarely changes, such as static images and web pages, to reduce the load on your network while serving content closer to the user to reduce latency. CDNs can work together with your load balancer to minimize the load on your network and other infrastructure.

Finally, connecting your services together can become a challenge as you scale. Using a service mesh, individual instances of a service register themselves with the service mesh. Instead of addressing services by individual IPs or constantly updating a DNS entry, new instances of the service register themselves, and the service mesh uses an internal DNS address to balance traffic to those instances.

One of the benefits of using Consul is its ability to build and maintain a service mesh. The example below defines a service in Consul:

```hcl

service {
  name = "redis"
  id   = "redis"
  port = 80
  tags = ["primary"]

  tagged_addresses = {
    lan = {
      address = "192.168.0.55"
      port    = 8000
    }

    wan = {
      address = "198.18.0.23"
      port    = 80
    }
  }
}
```

In the example above, every machine that's a part of the Consul service mesh can send a request to `redis.service.consul` to reach this service.
## Respond to scale issues

Your approach to reacting to growing capacity needs often depends on your cloud provider. For example, AWS, GCP, and Azure do not place limits on the bandwidth an individual subnet can accommodate, rather they place limitations on resources such as compute instances and other individual pieces of your infrastructure. Refer to your cloud provider documentation to learn more.

It is important to monitor the key metrics that you identified in your load and stress testing and configure alerts to notify you when you are approaching the limitations of your network. Monitoring also lets you have better insight into user's patterns and changing needs over time, letting you better adapt your network to these changing use cases. While you can make design decisions early to allow your network to help address capacity issues early, such as autoscaling and load balancing, it is still important to implement proper monitoring that can catch situations that you may not have designed for early before they affect the user.

HashiCorp resources:

- Read the [Monitor network traffic](/well-architected-framework/optimize-systems/monitor-system-health/monitor-network) Well-Archited Framework documentation.
- Learn to [setup monitoring agents](/well-architected-framework/define-and-automate-processes/monitor/setup-monitoring-agents)
- Configure [dashboards and alerts](/well-architected-framework/define-and-automate-processes/monitor/dashboards-alerts)
- Read the [Manage network ingress and egress for zero trust security](/well-architected-framework/secure-systems/infrastructure/manage-network-ingress-egress) Well-Archited Framework documentation.
## Next steps

In this section of Select and design infrastructure, you learned how to profile the workload on your network with load and stress tests, react to growing networking needs, and design to minimize the latency between your applications and services. Select and design infrastructure is part of the [Optimize systems pillar](/well-architected-framework/optimize-systems).

To learn more about how to design and scale your infrastructure, refer to the following resources:

- [Select and scale compute instances](/well-architected-framework/optimize-systems/select-design/network)
- [Design your databases](/well-architected-framework/optimize-systems/select-design/database)