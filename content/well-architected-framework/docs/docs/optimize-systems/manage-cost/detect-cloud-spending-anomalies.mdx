---
page_title: How to catch cloud spending anomalies before they spike
description: Catch unusual cloud spending patterns before they become costly. Learn how to implement anomaly detection with alerts using infrastructure as code.
---

# How to catch cloud spending anomalies before they spike

Monitoring for cloud spending anomalies help you identify cost issues that budgets miss. After [creating cloud budgets](/well-architected-framework/optimize-systems/manage-cost/create-cloud-budgets), you can implement anomaly detection to catch unusual spending patterns that fall within budget limits but indicate problems. For example, if your monthly cloud spending suddenly doubles from $2,000 to $4,000 but remains under your $5,000 budget, a budget alert would not trigger. However, anomaly detection would flag this unusual increase for investigation.

## Why detect spending anomalies

Anomaly detection addresses the following challenges that static budgets cannot solve:

**Pattern-based cost issues:** Budgets only alert when you exceed thresholds, but anomaly detection identifies unusual spending patterns even when costs remain within budget limits.

**Rapid cost escalation:** Misconfigured autoscaling, forgotten test resources, or unauthorized usage can escalate costs quickly before manual reviews detect them.

**Environment-specific baselines:** Each environment has different normal spending patterns, and anomaly detection learns these baselines automatically rather than requiring manual threshold configuration for each scenario.

**Early problem detection:** Machine learning-based detection identifies cost anomalies within hours rather than waiting for monthly reviews or budget threshold breaches.

Most cloud providers offer machine learning-based anomaly detection that learns your normal usage patterns and alerts you when spending deviates from the baseline. You can configure anomaly detection with AWS Cost Anomaly Detection and Azure Cost Management using Terraform.

## Set up anomaly detection in AWS

The following is an example Terraform configuration that sets up cost anomaly detection with email alerts in AWS. Cost anomaly detection will detect scenarios like the EC2 spending increase described earlier.

```hcl
resource "aws_ce_anomaly_monitor" "test" {
  name              = "AWSServiceMonitor"
  monitor_type      = "DIMENSIONAL"
  monitor_dimension = "SERVICE"
}

resource "aws_ce_anomaly_subscription" "test" {
  name      = "DAILYSUBSCRIPTION"
  frequency = "DAILY"

  monitor_arn_list = [
    aws_ce_anomaly_monitor.test.arn
  ]

  subscriber {
    type    = "EMAIL"
    address = "abc@example.com"
  }

  threshold_expression {
    dimension {
      key           = "ANOMALY_TOTAL_IMPACT_ABSOLUTE"
      match_options = ["GREATER_THAN_OR_EQUAL"]
      values        = ["100"]
    }
  }
}
```

The configuration includes the following key components:

- **aws_ce_anomaly_monitor:** Tracks spending patterns across all AWS services including EC2, S3, and Lambda.
- **frequency = "DAILY":** Sends a daily summary of detected anomalies.
- **threshold_expression:** Alerts when the anomaly's financial impact meets or exceeds $100.

HashiCorp resources:

- Terraform resource: [aws_ce_anomaly_subscription](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ce_anomaly_subscription)
- Terraform resource: [azurerm_cost_anomaly_alert](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/cost_anomaly_alert)
- Start learning Terraform with the [Get started tutorials](/terraform/tutorials).

External resources:

- [AWS getting started with AWS Cost Anomaly Detection](https://docs.aws.amazon.com/cost-anomaly/latest/userguide/what-is-cost-anomaly.html)
- [Azure identify anomalies and unexpected changes in cost](https://learn.microsoft.com/en-us/azure/cost-management-billing/understand/analyze-unexpected-charges)
- [Google cloud anomaly detection overview](https://cloud.google.com/bigquery/docs/anomaly-detection-overview)

In this section of Manage cost, you learned about detecting cloud spending anomalies using Terraform. Create cloud budgets is part of the [Optimize systems](/well-architected-framework/optimize-systems).

To learn more about managing resources with Terraform, view the following resources:

- [Reduce costs with Terraform Cloud ephemeral workspaces](https://www.youtube.com/watch?v=-woCmG8yGdA)
- [Create and implement a cloud resource tagging strategy](/well-architected-framework/optimize-systems/lifecycle-management/tag-cloud-resources)
- [Prevent cloud cost overruns with automated budgets and spending alerts](/well-architected-framework/optimize-systems/manage-cost/create-cloud-budgets)