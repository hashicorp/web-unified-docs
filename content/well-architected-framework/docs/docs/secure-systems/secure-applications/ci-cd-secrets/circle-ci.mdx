---
page_title: CircleCI
description: Integrate CircleCI with HashiCorp Vault using OIDC authentication. Retrieve static and dynamic secrets securely with comprehensive audit logging.
---

# CircleCI

CircleCI pipelines require secure access to secrets like API keys, database credentials, and certificates. Storing these secrets directly in CircleCI environment variables or hardcoding them in configuration files creates security risks. A more secure approach is to integrate CircleCI with Vault using OpenID Connect (OIDC) authentication, allowing pipelines to retrieve secrets dynamically without storing long-lived credentials.

## Why integrate CircleCI with Vault

Integrating CircleCI with Vault addresses the following security and operational challenges in pipeline automation:

**Eliminate secret sprawl:** Vault centralizes secret storage so pipelines retrieve credentials on-demand from a single source, reducing the need to duplicate secrets across multiple CircleCI projects and contexts. Centralized storage simplifies rotation and reduces the risk of exposure.

**Replace long-lived credentials:** Vault generates temporary credentials for each pipeline run that automatically expire, minimizing exposure windows compared to long-lived static credentials.

**Enhance audit capabilities:** Vault provides comprehensive audit logging that tracks every secret access with pipeline identity and timestamp, supporting organizations that require detailed compliance reporting and extended retention periods.

**Enable automatic rotation:** Vault automates credential rotation and distributes updated credentials without requiring pipeline configuration changes, reducing operational overhead and maintaining security posture.

## Prerequisites

Before integrating CircleCI with Vault, you need the following:

- A Vault instance or HCP Vault accessible from CircleCI runners over the network
- CircleCI organization with administrator access to configure projects and contexts
- A Vault JWT auth method configured to trust CircleCI's OIDC issuer
- Vault policies that grant CircleCI the necessary read permissions for your secrets
- We recommend TLS encryption between CircleCI runners and Vault

## Integration pattern

CircleCI pipelines authenticate to Vault using native OIDC tokens generated automatically for each workflow run:

1. **Authenticate:** Pipeline uses the automatically generated `$CIRCLE_OIDC_TOKEN` environment variable to authenticate to Vault using the JWT auth method
2. **Retrieve secrets:** Pipeline calls Vault API to retrieve static secrets from KV engine or dynamic credentials from secrets engines
3. **Use in deployment:** Secrets are available as environment variables in pipeline steps

The following example shows a minimal OIDC authentication pattern for CircleCI workflows:

```yaml
version: 2.1

jobs:
  deploy:
    docker:
      - image: cimg/base:stable
    steps:
      - checkout
      - run:
          name: Retrieve secrets from Vault
          command: |
            # Authenticate to Vault with OIDC token
            export VAULT_ADDR="https://vault.example.com:8200"
            export VAULT_TOKEN=$(vault write -field=token auth/jwt/login \
              role=circleci-role \
              jwt=$CIRCLE_OIDC_TOKEN)

            # Retrieve database password from Vault
            export DB_PASSWORD=$(vault kv get -field=password secret/database/production)

            # Use secret in deployment
            ./deploy.sh

workflows:
  deploy-workflow:
    jobs:
      - deploy:
          context: vault-context
```

The workflow authenticates to Vault using the CircleCI-generated OIDC token available as `$CIRCLE_OIDC_TOKEN`, retrieves a database password from Vault's KV secrets engine, and uses it in deployment. The OIDC token is automatically generated for each workflow run and requires no manual credential management.

For complete implementation guidance including Vault configuration, pipeline YAML examples for static and dynamic secrets, and OIDC setup instructions, review the [CircleCI OIDC documentation](https://circleci.com/docs/openid-connect-tokens) and HashiCorp resources below.

## HashiCorp resources

Vault authentication for CI/CD:

- Read the [Vault authentication methods documentation](/vault/docs/auth) for an overview of available auth methods
- Learn about [JWT/OIDC auth method](/vault/docs/auth/jwt) for token-based pipeline authentication
- Complete the [OIDC auth method tutorial](/vault/tutorials/auth-methods/oidc-auth) to understand OIDC authentication patterns

Vault secrets and dynamic credentials:

- Understand [dynamic and static secrets](/vault/tutorials/get-started/understand-static-dynamic-secrets) to choose the right approach for your pipelines
- Read the [KV secrets engine documentation](/vault/docs/secrets/kv) for static secret storage
- Learn about [AWS secrets engine](/vault/docs/secrets/aws) for dynamic cloud credentials

### External resources

- Watch [Inject secrets from HashiCorp Vault into CircleCI](https://www.youtube.com/watch?v=l6lG7FR5_Ow) with Rosemary Wang (HashiCorp) and Angel Rivera (CircleCI) for a hands-on demonstration
- Review [code examples from the video](https://github.com/punkdata/nodejs-circleci/tree/vault) for working CircleCI-Vault integration
- Read [CircleCI OIDC tokens documentation](https://circleci.com/docs/openid-connect-tokens) for token configuration details
- Reference [CircleCI configuration reference](https://circleci.com/docs/configuration-reference) for pipeline syntax

## Next steps

In this section of [managing CI/CD secrets](/well-architected-framework/secure-systems/secure-applications/ci-cd-secrets), you learned about CircleCI and Vault integration. CircleCI and Vault integration is part of the [Secure systems pillar](/well-architected-framework/secure-systems).

- Review the [CI/CD secrets overview](/well-architected-framework/secure-systems/secure-applications/ci-cd-secrets) for architectural guidance across platforms
- Compare [dynamic and static secrets in CI/CD](/well-architected-framework/secure-systems/secure-applications/ci-cd-secrets/dynamic-and-static-secrets) to choose the right secrets strategy
