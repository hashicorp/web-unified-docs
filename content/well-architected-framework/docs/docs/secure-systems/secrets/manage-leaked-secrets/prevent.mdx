---
page_title: Strategies to prevent credential leaks and secret exposure
description: Prevent credential leaks with separation of duties, dynamic secrets, SSO, and centralized management. Reduce breach risk and meet compliance requirements.
---

# Prevent leaked secrets

Leaked secrets and exposed credentials give attackers direct access to your infrastructure. API keys, passwords, and access tokens accidentally committed to code repositories or exposed in logs create immediate security risks. You can significantly reduce credential exposure and breach impact by implementing layered security controls.

This section outlines the following essential strategies to safeguard your secrets:

- **Separation of duties:** Distribute security responsibilities across teams
- **Restrict access to secrets:** Implement least-privilege access controls
- **Dynamic credentials:** Use short-lived, automatically rotating credentials
- **Single sign-on (SSO):** Centralize authentication across systems
- **Centralized secret management:** Store and retrieve secrets from an secrets management platform
- **Secure remote access:** Apply zero trust principles to network access

## Why prevent leaked secrets

**Reduce breach impact:** Leaked credentials give attackers direct access to your systems and data. When secrets like API keys, passwords, or access tokens become exposed, attackers can authenticate as legitimate users or services, bypassing traditional security controls and causing immediate damage to your infrastructure.

**Minimize credential exposure windows:** Long-lived static credentials create persistent security risks. Once compromised, these credentials remain valid until you manually rotate them, giving attackers extended time to exploit your systems. During this window, attackers can exfiltrate data, modify configurations, or establish persistent access mechanisms.

**Prevent cascading security failures:** A single leaked secret often lets attackers access multiple systems. Organizations typically reuse credentials across environments or grant overly broad permissions, meaning one exposed secret can compromise development, staging, and production environments simultaneously.

**Meet compliance requirements:** Government and industry regulations mandate specific controls for credential management and access. Organizations must demonstrate separation of duties, least privilege access, and audit trails to satisfy frameworks like SOC 2, PCI DSS, and Sarbanes-Oxley. Failure to prevent credential leaks can result in compliance violations, failed audits, and significant financial penalties.

After understanding the risks of credential exposure, implement the following preventive strategies.

## Implement separation of duties

Separation of duties (also known as segregation of duties) is a security practice that reduces the risk of a data breach by ensuring no single person has control over all aspects of a workflow. Government or industry regulations may require separation of duties, for example, Sarbanes-Oxley (SOX) in the United States.

A common implementation of separation of duties is to have separate teams responsible for software development, testing, building, and releasing the software to production. Separation of duties ensures no single person can introduce security issues into the workflow. For example, if a developer attempts to introduce a bug to steal fractions of a penny from every transaction, stages in the software development lifecycle would discover the bug.

## Limit secret access with least privilege

Apply least privilege principles when managing secrets by granting users and teams access only to the specific secrets they need to perform their jobs. This separation reduces risk by limiting who can view sensitive credentials.

Least privilege aligns with zero trust security models, which treat all users, devices, and networks as untrusted until you verify them. Traditional remote access solutions like virtual private networks (VPNs) violate least privilege by granting broad network access once you authenticate. Instead, grant users and devices access only to the specific resources they need for their work. Least privilege access reduces your attack surface and limits the potential damage from compromised credentials or insider threats.

HashiCorp resources:

- Learn how to [grant least privilege](/well-architected-framework/secure-systems/identity-access-management/grant-least-privilege) for identity and access management
- Detect exposed secrets with [HCP Vault Radar quickstart](/hcp/tutorials/get-started-hcp-vault-radar)
- Secure remote access with [HCP Boundary tutorials](/boundary/tutorials/get-started-hcp)
- Read the [introduction to zero trust security](https://www.hashicorp.com/en/resources/introduction-to-zero-trust-security) for foundational concepts
- Download the [zero trust security white paper](https://www.hashicorp.com/en/on-demand/a-guide-to-enabling-zero-trust-security-zts-solutions-page) for implementation guidance

External resources:

- [What is SOX (Sarbanes-Oxley Act) compliance?](https://www.ibm.com/think/topics/sox-compliance)
- [Verification and Test Methods for Access Control Policies/NIST SP 800-192](https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-192.pdf)
- [Data Breach Response: A Guide for Business](https://www.ftc.gov/business-guidance/resources/data-breach-response-guide-business)
- [NIST Cybersecurity Framework Quick Start Guides](https://www.nist.gov/cyberframework/quick-start-guides)

## Use dynamic credentials to limit exposure

Dynamic credentials reduce credential exposure risk by generating short-lived credentials that automatically expire. Dynamic credentials are short-lived credentials that services generate on demand and are valid for a limited time. Use dynamic credentials when SSO integration is not available or when you need time-limited access to databases and cloud providers. Because dynamic credentials are valid for a limited time, the risk of exposing the secret is reduced.

Workload identity federation (WIF) removes static credentials by creating trust relationships between systems. For example, GitHub Actions can authenticate to AWS without storing any AWS credentials. Once you complete the workload identity federation configuration, a service like Terraform or Vault creates dynamic credentials in the target platform. Compare this to conventional methods where you might provision a long lived service account with a key or password. These accounts still need to managed, and rotated. With workload identity federation, there is a trust between the systems so there is no risk to the service account secret being leaked. The service that provisions the dynamic credential revokes it when the workflow is complete or TTL expires.

Where SSO and workload identity federation diverge is that WIF uses the trust relationship to provision temporary, dynamic credentials. Dynamic credentials have a short TTL, so there is a limited risk if they become exposed. Configured services manage these credentials, so there is no need to revoke, renew, or replace the credentials.

HashiCorp Vault generates dynamic credentials for a variety of systems, including AWS, Azure, GCP, HCP Terraform, and several database platforms.

Vault Enterprise supports WIF integration with AWS, Azure, and GCP. Using WIF, you can configure the cloud provider auth method, or secrets engine without static service accounts.

You can configure your application to request dynamic credentials from Vault before connecting to a cloud service provider, or backend database. You can also use the HCP Terraform secrets engine to generate dynamic credentials for different Terraform providers. The secrets engine lets Terraform provision the defined resources without needing to store static credentials.

HashiCorp resources:

- Generate short-lived [database credentials with Vault](/vault/tutorials/db-credentials)
- Generate [cloud provider credentials with Vault](/vault/tutorials/secrets-management/azure-secrets) for AWS, Azure, and GCP
- Configure [federated workload identities with Vault](/vault/tutorials/enterprise/plugin-workoad-identity-federation) to eliminate static credentials
- Generate [dynamic credentials for HCP Terraform with Vault](/vault/tutorials/secrets-management/terraform-secrets-engine)
- Use [HCP Terraform dynamic provider credentials](/terraform/cloud-docs/workspaces/dynamic-provider-credentials) for cloud authentication
- Enable [self-service workflows with Vault-backed dynamic credentials](/terraform/tutorials/cloud/dynamic-credentials-no-code)
- Inject [secrets into Terraform using the Vault provider](/terraform/tutorials/secrets/secrets-vault)

While dynamic credentials reduce exposure windows, single sign-on reduces the total number of credentials you must manage.

## Use single sign-on

You can use single sign-on to prevent leaking secrets. Single sign-on (SSO) is a process that lets users or workloads authenticate to different services and applications using a single set of credentials. Use single sign-on when you need to centralize authentication across multiple services and reduce credential sprawl. Common identity providers used to configure SSO include Microsoft Active Directory and Okta.

Having different logins for different systems is a common source of process friction. People, teams, and workloads often need to use different authentication workflows. Process friction causes frustration and often leads people to try to circumvent security processes.

[NIST SP 800-63 Digital identity guidelines](https://csrc.nist.gov/pubs/sp/800/63/b/upd2/final) and [NIST SP 800-171](https://csrc.nist.gov/pubs/sp/800/171/r3/final) recommend using federated identity providers, and centralizing authentication to reduce security risks.

When reviewing tools and services to use for scanning for leaked secrets, ensure these services support SSO. SSO support limits friction in adopting the tools.

HashiCorp tools like HCP Vault Radar, HCP Terraform, Vault, and Boundary support SSO. SSO lets you adopt HashiCorp tools and integrate with your IdP. Your security team can access Vault Radar in the HCP Portal, and Vault with the same credentials.

For workloads that require access to Vault, Vault provides several auth methods that let you authenticate from trusted platforms such as AWS, Azure, GCP, and Kubernetes.

HashiCorp resources:

- Configure [Boundary OIDC authentication with Okta](/boundary/tutorials/identity-management/oidc-okta) for single sign-on
- Configure [Vault OIDC authentication with Okta](/vault/tutorials/auth-methods/vault-oidc-okta) for centralized authentication
- Read the [HCP SSO documentation](/hcp/docs/hcp/iam/sso) to configure identity providers
- Read the [HCP Terraform SSO documentation](/terraform/cloud-docs/users-teams-organizations/single-sign-on) for team authentication
- Use [Vault as an OIDC identity provider](/vault/docs/secrets/identity/oidc-provider) for other applications
- Configure the [Vault OIDC/JWT authentication method](/vault/docs/auth/jwt) for token-based authentication
- Implement [Vault Enterprise workload identity federation](/vault/tutorials/enterprise/plugin-workoad-identity-federation) for automated workload authentication

External resources: 

- [NIST SP 800-63 Digital identity guidelines](https://csrc.nist.gov/pubs/sp/800/63/b/upd2/final)
- [NIST SP 800-171](https://csrc.nist.gov/pubs/sp/800/171/r3/final)

## Centralize secret management

Centralized secret management provides visibility into all credentials across your organization, helping you identify leaked secrets and manage rotation effectively. Once you have a process in place to identify leaked secrets, you should verify whether the secret is in use and ensure that you are managing it effectively moving forward. Verifying secret usage and management are important to manage properly so you do not inadvertently rotate a secret used by another system and bring those services down.

When you identify a leaked secret, your solution should determine if the secret is in use and whether it's in your secret manager. Determining whether it's in use and where it's located helps you respond effectively by rotating or revoking the compromised credential. If the leaked secret is not stored in your secret manager, add the secret before you begin rotating it.

Another important feature for centralizing secrets management is the ability to copy or sync secrets to other systems. Secret synchronization helps with workloads or platforms that may be isolated, or systems that you cannot update to support a centralized secrets management solution.

Watch a demonstration of centralizing secrets management with HashiCorp Vault:

<VideoEmbed url="https://www.youtube.com/watch?v=XcW73DF0F9w" />

HashiCorp Vault is a centralized secrets management and security solution with several deployment options. If you are new to secrets management, you can start by storing secrets as key-value pairs, and update your workflows to read the secret directly from Vault. As your secrets management process matures, you can use short-lived, dynamic credentials which are valid for a specified period of time. Dynamic credentials further limit the effect if you do leak a secret because Vault automatically revokes it after the specified time, or you can manually revoke it and request new credentials.

You can prevent storing secrets in your code by securing your secrets in a centralized secrets management system such as Vault, and then referencing these secrets in your code. The following Python example shows how to use Vault client libraries inside your application code to store and retrieve secret values.

<CodeBlockConfig hideClipboard>

```python
read_response = client.secrets.kv.read_secret_version(path='my-secret-password')
password = read_response['data']['data']['password']
```

</CodeBlockConfig>

The client retrieves the password value from Vault at runtime, ensuring credentials never exist in your codebase. Your application always uses current credentials without requiring redeployment when secrets rotate.

HashiCorp resources:

- Learn [Vault foundations](/vault/tutorials/get-started) with hands-on tutorials
- Get started with [HCP Vault Dedicated](/vault/tutorials/get-started-hcp-vault-dedicated) for managed secrets management
- [Sign up for HCP Vault Dedicated](https://portal.cloud.hashicorp.com/sign-in) to deploy a managed Vault cluster

External resources:

- [OWASP Secrets Management Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html)

## Secure remote access with zero trust principles

Securing remote access to your systems is an important part of a defense-in-depth strategy. Traditional remote access solutions such as VPNs often provide access to entire segments of the network, potentially exposing system to users and workloads that do not need to connect. Broad network access is anti-pattern to modern security practices such as separation of duties, and zero trust.

Another challenge is with modern deployment practices. Workloads are often ephemeral, meaning you create and destroy them as needed. The ephemeral nature of modern deployments adds challenges to managing remote access and authentication to these systems.

HashiCorp Boundary is a remote access solution that follows zero trust principles and supports dynamic host catalogs which is useful for ephemeral workloads. Boundary lets platform teams specify only the systems that a user requires access to instead of the entire network, reducing unauthorized access and meeting zero trust security requirements. Zero trust access reduces the risk of a data breach and lets organizations prove compliance relative to separation of duties.

Dynamic host catalog plugins for major cloud providers automate the discovery and configuration of Boundary. As workloads are provisioned and destroyed, the Boundary host catalog remains up to date with the current state of the environment.

Boundary also supports credential brokering and SSH certificate injection. Credential brokering lets users connect to systems they have been granted access to without having to pass credentials through the CLI or Boundary Desktop application. In addition to Boundary native credential management, you can also integrate Boundary with HashiCorp Vault. Vault integration lets you take advantage of Vault dynamic credentials, limiting the total lifetime of the credential used for a given session.

HashiCorp resources:

- Get started with [HCP Boundary](/boundary/tutorials/get-started-hcp) for zero trust access
- Configure [Boundary host management](/boundary/tutorials/host-management) for dynamic infrastructure
- Implement [Boundary credential management](/boundary/tutorials/credential-management) for brokered access
- Securely [connect to Kubernetes using Boundary](/boundary/tutorials/kubernetes-connect)

## Next steps

In this section of how to [manage leaked secrets](/well-architected-framework/secure-systems/secrets/manage-leaked-secrets), you learned about how to prevent leaked secrets in your organization. Managing leaked secrets is part of the [Secure systems pillar](/well-architected-framework/secure-systems).