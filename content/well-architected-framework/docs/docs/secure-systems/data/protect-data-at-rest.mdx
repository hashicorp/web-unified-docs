---
page_title: Protect data at rest
description: Encrypt stored data with Vault's security barrier and access controls to protect databases, backups, and storage systems from unauthorized access.
---

# Protect data at rest

Data at rest represents any information stored in non-volatile storage such as databases, file systems, or backup media. After you [classify your data](/well-architected-framework/secure-systems/data/classify-data) into sensitivity levels, encrypt confidential and restricted data to protect against unauthorized access. Encryption methods include file-level encryption using Pretty Good Privacy (PGP), database encryption with Transparent Data Encryption (TDE) in Microsoft SQL Server, or storage-level encryption in services like Amazon S3.

## Why protect data at rest

**Prevent unauthorized access to stored data:** Unencrypted backups and storage systems remain vulnerable even when you encrypt data in transit. A major bank lost an unencrypted backup tape containing customers' social security numbers and bank account information. Modern cloud storage misconfigurations continue to expose datasets, making storage-level security critical.

**Implement defense in depth:** Storage encryption alone is insufficient. Many storage services encrypt data but use basic authentication, leaving information vulnerable to brute force attacks and phishing. You must encrypt both the data itself and implement strong access controls to protect against multiple attack vectors.

**Manage encryption keys securely:** Storing encryption keys alongside encrypted data defeats the purpose of encryption. Separating key management from data storage ensures attackers who compromise your storage systems cannot decrypt the data without also compromising your key management system.

## Protect data at rest with Vault

Vault uses a security barrier that automatically encrypts all data using 256-bit AES-GCM encryption. Vault stores only encrypted data regardless of the backend storage type, and applications must authenticate to receive tokens with policies that authorize access.

You shouldn't store large data volumes directly in Vault. Instead, store encryption keys in Vault and encrypt data in your primary storage system. For example, when using Microsoft SQL Server with Transparent Data Encryption (TDE), store the Key Encryption Key (KEK) in Vault's KV secrets engine rather than moving database contents to Vault. The KEK encrypts the Data Encryption Key (DEK), which encrypts your database content.

```hcl
# Store the database encryption key in Vault's KV engine
resource "vault_kv_secret_v2" "db_kek" {
  mount = "secret"
  name  = "database/mssql/kek"
  
  data_json = jsonencode({
    key = var.database_kek
  })
}

# Reference the KEK for database TDE configuration
data "vault_kv_secret_v2" "db_kek" {
  mount = "secret"
  name  = "database/mssql/kek"
}
```

The Vault configuration stores the KEK securely while allowing your database to manage encrypted data efficiently. Only applications with proper Vault authentication can access the encryption key.

Control access to stored data using dynamic credentials. Vault generates time-limited credentials that automatically expire, eliminating long-lived secrets. For example, when your CI/CD pipeline needs database access, Vault issues temporary PostgreSQL credentials that expire when the pipeline completes.

```hcl
# Configure Vault to generate dynamic PostgreSQL credentials
resource "vault_database_secret_backend_connection" "postgres" {
  backend       = vault_mount.db.path
  name          = "production-db"
  allowed_roles = ["pipeline"]

  postgresql {
    connection_url = "postgresql://{{username}}:{{password}}@postgres:5432/myapp"
  }
}

resource "vault_database_secret_backend_role" "pipeline" {
  backend             = vault_mount.db.path
  name                = "pipeline"
  db_name             = vault_database_secret_backend_connection.postgres.name
  creation_statements = ["CREATE ROLE \"{{name}}\" WITH LOGIN PASSWORD '{{password}}' VALID UNTIL '{{expiration}}' IN ROLE readonly;"]
  default_ttl         = 3600
  max_ttl             = 7200
}
```

The Vault database secrets engine generates unique credentials for each pipeline run, automatically revoking them after one hour. After encrypting data at rest, also [encrypt data in transit](/well-architected-framework/secure-systems/data/protect-data-in-transit) to protect information throughout its lifecycle.

HashiCorp resources:

- [Classify data based on sensitivity levels](/well-architected-framework/secure-systems/data/classify-data)
- [Protect sensitive data throughout its lifecycle](/well-architected-framework/secure-systems/data/protect-sensitive-data)
- [Encrypt data in transit using Vault and Consul](/well-architected-framework/secure-systems/data/protect-data-in-transit)
- [Replace sensitive values with secure tokens](/well-architected-framework/secure-systems/data/tokenize-data)
- [Generate dynamic database credentials with Vault](/vault/tutorials/db-credentials)
- [Store and version secrets with Vault's KV engine](/vault/tutorials/secrets-management/versioned-kv)
- [Securely store secrets for CI/CD pipelines](/well-architected-framework/secure-systems/secure-applications/ci-cd-secrets)
- [Vault Key/Value (KV) secrets engine documentation](/vault/docs/secrets/kv/kv-v2)
- [Enable transparent data encryption for Microsoft SQL with Vault](/vault/docs/platform/mssql)

External resources:

- [Bank of New York Mellon Investigated for Lost Data Tape](https://www.bankinfosecurity.com/bank-new-york-mellon-investigated-for-lost-data-tape-a-862)
- [What are cloud leaks?](https://www.upguard.com/blog/what-are-cloud-leaks)
- [NIST Block Cipher Techniques](https://csrc.nist.gov/projects/block-cipher-techniques/bcm/current-modes)

## Next steps

In this section of how to Secure data, you learned how to encrypt data at rest using Vault's security barrier and dynamic credentials. After securing stored data, [encrypt data in transit](/well-architected-framework/secure-systems/data/protect-data-in-transit) to protect information as it moves between systems. Protect data at rest is part of the [Secure systems pillar](/well-architected-framework/secure-systems).
