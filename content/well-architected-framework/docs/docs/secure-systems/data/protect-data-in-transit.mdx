---
page_title: Protect data in transit
description: Encrypt data moving between systems using TLS, Vault's Transit engine, and Consul service mesh to protect sensitive information during transmission.
---

# Protect data in transit

Data in transit includes any information moving between systems, such as passwords, secrets, API keys, and application data. After [classifying your data](/well-architected-framework/secure-systems/data/classify-data) and [encrypting data at rest](/well-architected-framework/secure-systems/data/protect-data-at-rest), protect confidential information during transmission to maintain security throughout the data lifecycle.

## Why protect data in transit

**Prevent man-in-the-middle attacks:** Unencrypted network traffic allows attackers to intercept passwords, API keys, and sensitive data during transmission. They can also inject malicious code before forwarding traffic to recipients, compromising both confidentiality and integrity.

**Verify identity of communication endpoints:** TLS certificates enable clients to verify server identity and vice versa, preventing attackers from impersonating legitimate services. Without mutual authentication, applications cannot confirm they're communicating with trusted systems.

**Reduce encryption key management burden:** Managing encryption keys for data in transit creates operational overhead. Organizations need specific key types, rotation policies, and compliance requirements that demand dedicated key management systems to handle cryptographic operations at scale.

## TLS for client server communication

Human client-to-machine communication is the first hop of data in transit, most commonly by using HTTPS instead of HTTP with a certificate. TLS/SSL certificates encrypt traffic between web browsers, CLI tools like cURL, and API endpoints. You can also use TLS to secure FTP (FTPS, not to be confused with SFTP, which uses the SSH protocol), IMAP (IMAPS), POP3 (POP3S), and SMTP (SMTPS), among others.

HTTP is dangerous because an attacker can intercept the traffic and insert malicious code before forwarding it to the user's browser (a man-in-the-middle attack). The Transport Layer Security (TLS) protocol solves this problem by allowing the client to verify the identity of the server and allows the server to verify the identity of the client. You should use the latest TLS version (v1.3) because it provides stronger security through improved encryption algorithms and patches known vulnerabilities. It also offers better performance with faster connection times and enhanced privacy protections.

Protect yourself by verifying that your [browser supports TLS v1.3](https://caniuse.com/tls1-3). Additionally, you can identify whether a site supports HTTP Strict Transport Security (HSTS) to protect against man-in-the-middle attacks using the Qualys SSL Server Test. Most web browsers show if a website uses TLS encryption, usually with a lock icon on the address bar.

## Encrypt data in-transit with Vault

Vault's Transit secrets engine provides cryptography as a service, handling encryption and decryption operations for data in transit without storing the data itself. The Transit engine supports multiple key types, manages encryption key lifecycles, and performs operations like signing, verification, hashing, and HMAC generation.

```hcl
# Enable and configure Vault Transit secrets engine
resource "vault_mount" "transit" {
  path = "transit"
  type = "transit"
}

resource "vault_transit_secret_backend_key" "payment_data" {
  backend = vault_mount.transit.path
  name    = "payment-encryption"
  
  deletion_allowed = false
  exportable       = false
  type             = "aes256-gcm96"
}

# Application encrypts data before sending over network
data "vault_generic_secret" "encrypted_payment" {
  path = "${vault_mount.transit.path}/encrypt/${vault_transit_secret_backend_key.payment_data.name}"
  
  data_json = jsonencode({
    plaintext = base64encode("4111111111111111")
  })
}
```

The Transit engine encrypts the credit card number before transmission, and only authorized applications with valid Vault tokens can decrypt the data. Vault manages key rotation automatically without requiring application changes.

For sensitive data requiring specific output formats like credit card numbers, use Vault's Transform secrets engine with format-preserving encryption (FPE). The Transform engine, available in Vault Enterprise or HCP Vault Dedicated, maintains the original data format while encrypting, enabling compatibility with systems expecting specific data patterns. For detailed guidance, see [tokenize data](/well-architected-framework/secure-systems/data/tokenize-data).

<VideoEmbed url="https://www.youtube.com/watch?v=fno3bvJuFSk"/>

## Encrypt data in-transit with Consul

Unencrypted cross-application communications are susceptible to man-in-the-middle attacks. An application can protect itself against malicious activities by requiring mTLS (mutual TLS) on both ends of the application to application communications.

Consul automatically enables mutual TLS (mTLS) for all service-to-service communication within the service mesh. Legacy applications can use mTLS through local Consul proxies that intercept network traffic without requiring application modifications. Consul generates and rotates certificates automatically, enabling rapid TLS version upgrades across your entire infrastructure.

```hcl
# Configure Consul service mesh with automatic mTLS
resource "consul_config_entry" "service_defaults" {
  name = "api-service"
  kind = "service-defaults"

  config_json = jsonencode({
    Protocol = "http"
    MeshGateway = {
      Mode = "local"
    }
  })
}

resource "consul_config_entry" "proxy_defaults" {
  kind = "proxy-defaults"
  name = "global"

  config_json = jsonencode({
    Config = {
      protocol = "http"
    }
    MeshGateway = {
      Mode = "local"
    }
  })
}
```

The Consul configuration enables mTLS automatically for services registered in the mesh. Consul also secures external traffic entering the service mesh through Ingress and API Gateways. Enable TLS on these gateways to encrypt traffic from external clients to your mesh services.

HashiCorp resources:

Data security documentation:

- [Classify data based on sensitivity levels](/well-architected-framework/secure-systems/data/classify-data) to organize information by access requirements
- [Protect sensitive data throughout its lifecycle](/well-architected-framework/secure-systems/data/protect-sensitive-data) from creation to deletion
- [Encrypt data at rest with Vault's security barrier](/well-architected-framework/secure-systems/data/protect-data-at-rest) to protect stored information
- [Replace sensitive values with secure tokens](/well-architected-framework/secure-systems/data/tokenize-data) using format-preserving encryption

Vault encryption as a service:

- Read the [Vault Transit secrets engine documentation](/vault/docs/secrets/transit) for cryptography as a service
- Learn how to [encrypt data in transit using Vault's Transit engine](/vault/tutorials/encryption-as-a-service/eaas-transit) for network security
- [Explore Vault's encryption capabilities](/vault/tutorials/encryption-as-a-service) with hands-on tutorials
- [Transform sensitive data with format-preserving encryption](/vault/tutorials/adp/transform) for compliance requirements

Consul service mesh security:

- Learn how to [update Consul agents to securely communicate with TLS](/consul/tutorials/archive/tls-encryption-secure-existing-datacenter) for cluster security
- [Enable TLS on Consul ingress gateways](/consul/docs/north-south/ingress-gateway#custom-tls-certificates-via-secret-discovery-service-sds) for external traffic
- [Enable TLS on Consul API gateway listeners](/consul/docs/api-gateway/configuration/gateway#listeners-tls) for API security

External resources:

- [Verify your browser supports TLS v1.3](https://caniuse.com/tls1-3)
- [View Qualys SSL Server Test on hashicorp.com](https://www.ssllabs.com/analyze.html?d=hashicorp.com&latest)

## Next steps

In this section of how to Secure data, you learned how to encrypt data in transit using TLS, Vault's Transit engine, and Consul service mesh. Combined with encrypting data at rest, these techniques protect sensitive information throughout its lifecycle. For highly sensitive data like credit card numbers, consider [tokenizing data](/well-architected-framework/secure-systems/data/tokenize-data) to replace sensitive values with secure tokens. Protect data in transit is part of the [Secure systems pillar](/well-architected-framework/secure-systems).
