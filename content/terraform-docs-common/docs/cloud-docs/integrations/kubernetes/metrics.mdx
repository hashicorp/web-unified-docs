---
page_title: HCP Terraform Operator for Kubernetes Metrics
description: >-
  Use Prometheus-compatible metrics to monitor and gain insights into the HCP Terraform Operator for Kubernetes.
---

# HCP Terraform Operator for Kubernetes metrics

This topic provides reference information about the Prometheus-compatible metrics available in the HCP Terraform and Terraform Enterprise operators for Kubernetes.

## Available Metrics

The Operator exposes all metrics provided by the controller-runtime by default. The full list you can find on the [Kubebuilder documentation](https://book.kubebuilder.io/reference/metrics-reference.html).

Starting with version `2.10.0`, the operator introduces HCP Terraformâ€“specific metrics. These metrics use the prefix `hcp_tf_*`.

Below is the full list of the available metrics. Please note that the metrics are provided by the controllers -- see the Controller column for the corresponding metric.

| Metric name | Type | Description | Controller | Status |
|-------------|------|-------------|------------|--------|
| `hcp_tf_runs{run_status, agent_pool_id, agent_pool_name}` | Gauge | Pending runs by statuses. | RunsCollector | Alpha |
| `hcp_tf_runs_total{agent_pool_id, agent_pool_name}` | Gauge | Total number of pending Runs. | RunsCollector | Alpha |

## Scraping Metrics

The Operator exposes metrics in the [Prometheus](https://prometheus.io/) format for each controller. They are available at the standard `/metrics` path over the HTTPS port `8443`.

The metrics are protected by [kube-rbac-proxy](https://github.com/brancz/kube-rbac-proxy). This allows providing RBAC-based access to the metrics within the Kubernetes cluster.

How metrics are scraped will depend on how you operate your Prometheus server. The below example assumes that the [Prometheus Operator](https://github.com/prometheus-operator/prometheus-operator) is being used to run Prometheus.

If the HCP Terraform Operator is deployed using the [Helm chart](https://artifacthub.io/packages/helm/hashicorp/hcp-terraform-operator), a Kubernetes ClusterIP Service resource is created. This service should be used as a target for Prometheus. The service name is generated using the following template: `{{ .Release.Name }}-controller-manager-metrics-service`.

The following example shows a Prometheus Operator ConfigMap configured to scrape metrics from an HCP Terraform Operator Helm release named `hcpt-operator`. In this configuration, the service name is `hcpt-operator-controller-manager-metrics-service`.

```yaml
apiVersion: v1
data:
  ...
  prometheus.yml: |
    ...
    - job_name: hcpt-operator
      bearer_token_file: /var/run/secrets/kubernetes.io/serviceaccount/token
      scheme: https
      scrape_interval: 15s
      scrape_timeout: 5s
      static_configs:
      - targets:
        - hcpt-operator-controller-manager-metrics-service:8443
      tls_config:
        insecure_skip_verify: true
```

Please always refer to your company policies before adding new Prometheus targets.
