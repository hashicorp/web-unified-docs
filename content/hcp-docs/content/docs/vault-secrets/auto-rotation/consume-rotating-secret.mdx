---
page_title: Consume rotating secrets
sidebar_title: Consume rotating secrets
description: |-
  Consume rotating secrets in an HCP Vault Secrets app.
---

# Consume rotating secrets

@include 'alerts/vault-secrets-standard-only.mdx'

Static long-lived credentials pose a significant security risk due to the potential for accidental and malicious exposure as well as difficulties in revocation once the credentials are compromised. HCP Vault Secrets offers two ways of mitigating this risk: [dynamic secrets](/hcp/docs/vault-secrets/dynamic-secrets/index) auto-rotating secrets (described below). For a more in-depth comparison between these two secret types, please refer to [this section](/hcp/docs/vault-secrets#auto-rotating-vs-dynamic-secrets).

Auto-rotating secrets are credentials that rotate automatically on a periodic basis. They have a limited lifetime of 2 rotation periods (30, 60, or 90 days) and can be used by multiple consuming clients.

![Diagram showing how Auto-rotating Secrets are shared by multiple instances of
an application](/img/docs/vault-secrets/rotating-secret-consumption.png)

## Prerequisites

- An HCP IAM user or service principal with the [HCP reader
  role](/hcp/docs/vault-secrets/get-started/configure-user-permissions) or
  higher.
- An HCP Vault Secrets [app](/hcp/docs/vault-secrets/get-started/create-app) and
  [rotating secret](/hcp/docs/vault-secrets/auto-rotation) created.
- Authenticated to the [HCP Portal](/hcp/docs/vault-secrets/get-started/access-ui) or [HCP CLI](/hcp/docs/cli/commands/auth/login)

## How frequently should the secrets be consumed?

Auto-rotating secrets maintain overlapping sets of active credentials to eliminate
application downtime associated with rotation. At any given time, the latest two secret
versions will be active and available for consumption.
 
To ensure that your application is always consuming active credentials, we recommend
restarting it at least once every rotation interval. If your application consumes multiple
rotating secrets, it should be restarted at least once every `min(I1, I2, ..., In)` where
`I1, I2, ..., In` are the corresponding rotation intervals. For example, if the application
consumes secrets with rotation intervals of `[30, 30, 60, 90] days`, it should be restarted
once every 30 days, regardless of when the secrets actually rotate.

<Note>

If an auto-rotating secret is manually rotated, we recommend that any applications consuming
the secret should be restarted to fetch the latest version.

</Note>

<Note>

The recommendations above are not applicable when consuming secrets in Kubernetes
using Vault Secrets Operator -- it will ensure that the latest versions of secrets are
correctly propagated.

</Note>

## Examples

<Tabs>
<Tab heading="HCP portal">

<Note>

You can open a secret, and all versions of the secret using the CLI. Use the
HCP UI or API to open a specific version of a secret.

</Note>

![View auto-rotating secret](/img/docs/vault-secrets/view-gcp-rotating-secret.png)


</Tab>
<Tab heading="HCP CLI">

@include 'hcp-cli/commands/vault-secrets/open-examples.mdx'

</Tab>
<Tab heading="HCP API">

Open all secrets in an app:
```shell-session
curl \
--location "https://api.cloud.hashicorp.com/secrets/2023-11-28/organizations/${HCP_ORG_ID}/projects/${HCP_PROJ_ID}/apps/${APP_NAME}/secrets:open" \
--request GET \
--header "Authorization: Bearer ${HCP_API_TOKEN}" | jq
```

Open a single secret: 
```shell-session
curl \
--location "https://api.cloud.hashicorp.com/secrets/2023-11-28/organizations/${HCP_ORG_ID}/projects/${HCP_PROJ_ID}/apps/${APP_NAME}/secrets/${SECRET_NAME}:open" \
--request GET \
--header "Authorization: Bearer ${HCP_API_TOKEN}" | jq
```

</Tab>
<Tab heading="HCP Terraform provider">

Consuming rotating secrets using [HCP Terraform Provider](https://registry.terraform.io/providers/hashicorp/hcp/latest/docs/data-sources/vault_secrets_rotating_secret)

</Tab>
<Tab heading="Kubernetes">

Consuming rotating secrets in [Kubernetes](https://developer.hashicorp.com/vault/tutorials/kubernetes/vault-secrets-operator)

</Tab>
</Tabs>

## Additional resources

- [API reference - RotateSecret](https://developer.hashicorp.com/hcp/api-docs/vault-secrets/2023-11-28#RotateSecret)
- [API reference - OpenAppSecret](https://developer.hashicorp.com/hcp/api-docs/vault-secrets/2023-11-28#OpenAppSecret)
- [API reference - OpenAppSecretVersion](https://developer.hashicorp.com/hcp/api-docs/vault-secrets/2023-11-28#OpenAppSecretVersion)