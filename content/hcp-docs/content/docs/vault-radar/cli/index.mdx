---
page_title: Vault Radar CLI
description: |-
  Learn how to use Vault Radar CLI to scan files to detect unmanaged secrets.
---

# Vault Radar CLI

In addition to [the HCP Portal](https://portal.cloud.hashicorp.com/), Vault Radar offers an easy to use command-line
interface (CLI) to scan a various data source for unmanaged secrets to reduce
security vulnerability.

@include 'vault-radar/version-requirement.mdx'

## Download and install CLI

The HCP Vault Radar CLI is available for download from
[releases.hashicorp.com/vault-radar](https://releases.hashicorp.com/vault-radar/)
as a zip archive and from popular package managers. It is also available as an image
in [Docker Hub](https://hub.docker.com/r/hashicorp/vault-radar/).

<Tabs>
<Tab heading="Manual">

To install the HCP Vault Radar CLI, find the appropriate [package for your
system](https://releases.hashicorp.com/vault-radar/) and download it. The
`vault-radar` CLI is packaged as a zip archive.

After downloading the zip archive, unzip the package. The HCP Vault Radar
binary runs as a single binary named `vault-radar`. Any other files in the
package can be safely removed and `vault-radar` will still function.

The final step is to make sure that the `vault-radar` binary is available on the
PATH. See this page for instructions on setting the [PATH on Linux and
Mac](https://support.apple.com/guide/terminal/use-environment-variables-apd382cc5fa-4f58-4449-b20a-41c53c006f8f/mac)
This page contains instructions for setting the [PATH on
Windows](https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_environment_variables?view=powershell-7.2).

</Tab>
<Tab heading="macOS">

The installation steps provided were tested on macOS 14.4 and should work on
other versions that utilize the Homebrew package manager.

Refer to the [Homebrew installation
instructions](https://docs.brew.sh/Installation) if it is not already installed.

1. Install the HahsiCorp tap.

   ```shell-session
   $ brew tap hashicorp/tap
   ```

1. Install the HCP Vault Radar CLI.

   ```shell-session
   $ brew install vault-radar
   ```

1. Verify the installation.

   ```shell-session
   $ vault-radar --help

   Usage: vault-radar [--version] [--help] <command> [<args>]

   Available commands are:
       govern     Govern commands
       index      Index commands
       meter      Meter commands
       scan       Scan commands
       station    Station management
       version    Shows the vault-radar cli version and golang version
   ```

</Tab>
<Tab heading="Linux">

<Tabs>
<Tab heading="Ubuntu/Debian">

The installation steps provided were tested on Ubuntu 22.04 and should work on
other Debian based distributions that utilize the apt package manager.

1. Update the apt repository.

   ```shell-session
   $ sudo apt update
   ```

1. Download the HashiCorp GPG key.

   ```shell-session
   $ curl -fsSL https://apt.releases.hashicorp.com/gpg | sudo gpg --dearmor -o /usr/share/keyrings/hashicorp-archive-keyring.gpg
   ```

1. Add the HashiCorp repo.

   ```shell-session
   $ echo "deb [signed-by=/usr/share/keyrings/hashicorp-archive-keyring.gpg] https://apt.releases.hashicorp.com $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/hashicorp.list
   ```

1. Install the `vault-radar` CLI.

   ```shell-session
   $ sudo apt update && sudo apt install vault-radar -y
   ```

1. Verify the installation.

   ```shell-session
   $ vault-radar --help

   Usage: vault-radar [--version] [--help] <command> [<args>]

   Available commands are:
       govern     Govern commands
       index      Index commands
       meter      Meter commands
       scan       Scan commands
       station    Station management
       version    Shows the vault-radar cli version and golang version
   ```

</Tab>
<Tab heading="CentOS/RHEL">

The installation steps provided were tested on CentOS Stream 9 and should work
on other distributions that utilize the yum package manager.

1. Update the yum repository.

   ```shell-session
   $ sudo yum update
   ```

1. Add the HashiCorp repository.

   <Note>

   Refer to the [official
   packaging](https://www.hashicorp.com/official-packaging-guide) guide for the
   correct RHEL/CentOS or Fedora configuration.

   </Note>

   ```shell-session
   $ curl -fsSL https://rpm.releases.hashicorp.com/RHEL/hashicorp.repo | sudo tee /etc/yum.repos.d/hashicorp.repo
   ```

1. Install the `vault-radar` CLI.

   ```shell-session
   $ sudo yum update && sudo yum install vault-radar -y
   ```

1. Verify the installation.

   ```shell-session
   $ vault-radar --help

   Usage: vault-radar [--version] [--help] <command> [<args>]

   Available commands are:
       govern     Govern commands
       index      Index commands
       meter      Meter commands
       scan       Scan commands
       station    Station management
       version    Shows the vault-radar cli version and golang version
   ```

</Tab>
<Tab heading="Fedora">

The installation steps provided were tested on Fedora 39 using the dnf package
manager.

1. Update the dnf repository.

   ```shell-session
   $ sudo dnf update
   ```

1. Add the HashiCorp repository.

   <Note>

   Refer to the [official
   packaging](https://www.hashicorp.com/official-packaging-guide) guide for the
   correct RHEL/CentOS or Fedora configuration.

   </Note>

   ```shell-session
   $ sudo dnf config-manager --add-repo https://rpm.releases.hashicorp.com/fedora/hashicorp.repo
   ```

1. Install the `vault-radar` CLI.

   ```shell-session
   $ sudo dnf update && sudo dnf -y install vault-radar
   ```

1. Verify the installation.

   ```shell-session
   $ vault-radar --help

   Usage: vault-radar [--version] [--help] <command> [<args>]

   Available commands are:
       govern     Govern commands
       index      Index commands
       meter      Meter commands
       scan       Scan commands
       station    Station management
       version    Shows the vault-radar cli version and golang version
   ```

</Tab>
<Tab heading="Amazon Linux">

The installation steps provided were tested on Amazon Linux 2 and should work on
other distributions that utilize the yum package manager.

1. Update the yum repository.

   ```shell-session
   $ sudo yum update
   ```

1. Add the HashiCorp repository.

   <Note>

   Refer to the [official
   packaging](https://www.hashicorp.com/official-packaging-guide) guide for the
   correct RHEL/CentOS or Fedora configuration.

   </Note>

   ```shell-session
   $ curl -fsSL https://rpm.releases.hashicorp.com/AmazonLinux/hashicorp.repo | sudo tee /etc/yum.repos.d/hashicorp.repo
   ```

1. Install the `vault-radar` CLI.

   ```shell-session
   $ sudo yum update && sudo yum install vault-radar -y

1. Verify the installation.

   ```shell-session
   $ vault-radar --help

   Usage: vault-radar [--version] [--help] <command> [<args>]

   Available commands are:
       govern     Govern commands
       index      Index commands
       meter      Meter commands
       scan       Scan commands
       station    Station management
       version    Shows the vault-radar cli version and golang version
   ```

</Tab>
</Tabs>

</Tab>
<Tab heading="Windows">

HashiCorp does not maintain installation binaries using Chocolatey or Scoop. The
latest version of the HCP Vault Radar CLI is available by manual installation.

This example downloads the Windows AMD64 binary using PowerShell. Use a Windows
account with appropriate permissions to extract the binary to the `Program Files`
directory and update the `PATH`.

1. Launch a PowerShell terminal using **Run as Administrator**. If prompted, click
   **Yes**.

1. Verify the latest (or desired) version of the HCP Vault Radar binary from
   [releases.hashicorp.com](https://releases.hashicorp.com/vault-radar/). For example, "0.6.0".

1.  Create some environment variables to configure the download:
   ```shell-session
   $Env:RadarVersion = "0.6.0"
   $Env:RadarArch = $Env:PROCESSOR_ARCHITECTURE.ToLower()
   $Env:RadarURL = "https://releases.hashicorp.com/vault-radar/${Env:RadarVersion}"
   $Env:RadarFile = "vault-radar_${Env:RadarVersion}_windows_${Env:RadarArch}.zip"
   ```

1. Download the zip archive to the current working directory.

   ```shell-session
   $ Invoke-WebRequest                         `
     -URI "${Env:RadarURL}/${Env:RadarFile}" `
     -OutFile "./${Env:RadarFile}"
   ```

1. Extract the archive file to the default program directory.

   ```shell-session
   $ Expand-Archive              `
     -Path ".\${Env:RadarFile}"  `
     -Destination "${Env:Programfiles}\HashiCorp\radar-cli\bin\"
   ```

1. Update the Windows user path:

   ```shell-session
   $ [System.Environment]::SetEnvironmentVariable("Path",
       "$Env:Path;${Env:Programfiles}\HashiCorp\radar-cli\bin",
       [System.EnvironmentVariableTarget]::User
     )
   ```

1. Close the session and re-open Powershell normally.

1. Verify the installation.

   ```shell-session
   $ vault-radar --help

   Usage: vault-radar [--version] [--help] <command> [<args>]

   Available commands are:
       govern     Govern commands
       index      Index commands
       meter      Meter commands
       scan       Scan commands
       station    Station management
       version    Shows the vault-radar cli version and golang version
   ```

</Tab>
<Tab heading="Docker">

The HCP Vault Radar CLI is also available as a Docker image. This image
can be used to run the CLI in a containerized environment.

1. Verify the latest (or desired) version of the HCP Vault Radar binary from
   [Docker Hub](https://hub.docker.com/r/hashicorp/vault-radar/tags). For example, "0.6.0".

1. Set the version as an environment variable.

   ```shell-session
   $ export VAULT_RADAR_VERSION=0.6.0
   ```

1. Pull the Docker image.

   ```shell-session
   $ docker pull hashicorp/vault-radar:${VAULT_RADAR_VERSION}
   ```

1. Run the Docker container.

   ```shell-session
   $ docker run --rm hashicorp/vault-radar:${VAULT_RADAR_VERSION} vault-radar --help
   ```

</Tab>
</Tabs>

## Dependencies

The Vault Radar CLI requires access to the following URLs:

- api.cloud.hashicorp.com
- auth.idp.hashicorp.com

Configure the necessary rules within your network to ensure the CLI can
access these URLs.

The following dependencies need to be installed on the machine `vault-radar` is
running on.

- [git](https://git-scm.com/downloads) - Required for `scan repo` and `scan confluence` commands
- [Docker engine](https://docs.docker.com/engine/install/) - Required for
  `scan docker-image` command.

## Usage

<CodeBlockConfig hideClipboard>

```shell-session
Usage: vault-radar [--version] [--help] <command> [<args>]

Available commands are:
    agent      Agent management
    govern     Govern commands
    index      Index commands
    install    Install commands
    meter      Meter commands
    scan       Scan commands
    version    Shows the vault-radar cli version and golang version
```

</CodeBlockConfig>

Some commands require a connection to HCP. You will need to set `HCP_PROJECT_ID`, `HCP_CLIENT_ID`, and `HCP_CLIENT_SECRET` from your HCP project. More info on generating service principal keys [here](/hcp/docs/vault-radar/cli/configuration/upload-results-to-hcp).

For more information, examples, and usage about a command, click on the name
of the command in the sidebar.

## Command help

To view a list of the available commands at any time, just run `vault-radar`
with no arguments:

```shell-session
$ vault-radar
```

Use `help` (or `-h` for shorthand) to see the specific command help output.

**Example:** See the help message for the `vault-radar scan aws-parameter-store`
command usage.

```shell-session
$ vault-radar scan aws-parameter-store -h
Usage: vault-radar scan aws-parameter-store [options]

  Scans AWS Parameter Store

Options:

  --region, -r             Specifies the region of AWS Parameter Store to scan (required)
  --outfile , -o           Specifies the file to store information about found secrets (required)
  --skip-history           If specified, scans only the most recent version of the parameters. Default is to scan all available versions
  --format, -f             Specifies the output format, csv, json, and sarif are supported. Defaults to csv
  --index-file             Specifies the index file path to use in order to determine which risks are managed
  --baseline, -b           Specifies the file with previous scan results. Only new secrets will be reported.
  --limit, -l              Specifies the maximum number of secrets to be reported. The scan will stop when the limit is reached
  --parameter-limit        Specifies the maximum number of parameters to be scanned. The scan will stop when the limit is reached
  --disable-ui             Specifies that the scan summary should not be logged to stdout
```

## Global flags and environment variables

### Disable UI

The `--disable-ui` flag disables logging the command status and summary to stdout.
This is particularly useful when you want to run a command in an environment where TTY
is not available like a CI/CD pipeline.

**Example:** Run the `scan aws-parameter-store` command without logging the summary to stdout.

```shell-session
$ vault-radar scan aws-parameter-store --region us-west-2 --outfile secrets.csv --disable-ui
```

### Index file

All the scan commands support the `--index-file` flag to specify the output file generated by
the `index` command. When this flag is specified, the scan command uses the index file to determine
which secrets are managed (i.e the secret is also detected in a secrets manager such as HashiCorp Vault).

**Example:** Run the `scan aws-parameter-store` command with the index file.

```shell-session
$ vault-radar scan aws-parameter-store --region us-west-2 \
  --outfile secrets.csv --index-file index.jsonl
```

See [How to generate a Vault Index](/hcp/docs/vault-radar/cli/index/vault#index-generation)

### Risks limit

All the scan commands support the `--limit` flag to specify the maximum number of secrets to be reported.
The scan will stop when the limit is reached.

**Example:** Run the `scan aws-parameter-store` command with the limit.

```shell-session
$ vault-radar scan aws-parameter-store --region us-west-2 \
  --outfile secrets.csv --limit 10
```

### Log level

The log level for the CLI can be configured using the `VAULT_RADAR_LOG_LEVEL` environment variable.
The default log level is `info`. The supported log levels are:

- `trace`
- `debug`
- `info`
- `warn`
- `error`

**Example:** Set the log level to `debug`.

```shell-session
$ export VAULT_RADAR_LOG_LEVEL=debug
```
