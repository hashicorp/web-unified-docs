---
page_title: scan aws-s3 command
description: |-
  The scan aws-s3 command is used for scanning an Amazon S3 bucket.
---

# scan aws-s3

@include 'beta-feature.mdx'

@include 'vault-radar/version-requirement.mdx'

The `scan aws-s3` command is used for scanning an Amazon S3 bucket.

## Authentication

The `scan aws-s3` comand needs permissions to list and get the objects in the
bucket, see this simplified policy document below. 

```json
{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Effect": "Allow",
            "Action": [
                "s3:ListBucket",
                "s3:GetObject"
            ],
            "Resource": "*"
        }
    ]
}
```

The `Resource` in the policy can be limited to the buckets that one wants to
scan. 

See [AWS Authentication](/hcp/docs/vault-radar/cli/configuration/aws-authentication) for
more information on how to authenticate with AWS.

## Usage

<CodeBlockConfig hideClipboard>

```plaintext
Usage: vault-radar scan aws-s3 [options]
```

</CodeBlockConfig>

### Scan all objects in a bucket

To scan all objects within a bucket and write the results to a CSV file (default
format).

```shell-session
$ vault-radar scan aws-s3 --bucket <BUCKET NAME> -r <REGION CODE> \
    -o <PATH TO OUTPUT>.csv
```

### Scan all objects in a bucket and output in JSON

To scan all objects within a bucket and write the results in [JSON
Lines](https://jsonlines.org/) format.

```shell-session
$ vault-radar scan aws-s3 --bucket <BUCKET NAME> -r <REGION CODE> \
    -o <PATH TO OUTPUT>.jsonl \
    -f json
```

### Scan all objects in a bucket with prefix

To scan all objects within a bucket beginning with a prefix.

```shell-session
$ vault-radar scan aws-s3 --bucket <BUCKET NAME> -r <REGION CODE> \
    --prefix <PREFIX> \
    -o <PATH TO OUTPUT>.jsonl \
    -f json
```

### Scanning using a baseline file

Perform a scan using a previous scan's result and write the new changes to an
outfile. With `-b` option, only new risks, risks that were not found in the
previous scan will be reported.  

```shell-session
$ vault-radar scan aws-s3 --bucket <BUCKET NAME> -r <REGION CODE> \
    -b <PATH TO BASELINE>.csv \
    -o <PATH TO OUTPUT>.csv
```

Note: it is expected that previous and current scans are "similar", 
e.g. both either latest version or history scans and same output format

### Scanning using a Vault index file

Perform a scan using a generated vault index and write the results to an
outfile. In this mode, if a risk was previously found in Vault, the scan results
will report the location in Vault as well.

```shell-session
$ vault-radar scan aws-s3 --bucket <BUCKET NAME> -r <REGION CODE> \
    -o <PATH TO OUTPUT>.csv \
    --index-file <PATH TO VAULT INDEX>.jsonl
```

[How to generate a Vault Index](/hcp/docs/vault-radar/cli/index/vault#index-generation)

### HCP connection scanning behavior

The scan commands require an HCP cloud connection to ensure 
that hashes are generated using a shared salt from the
cloud keeping consistency across scans. In order to populate the HCP connection
information needed, refer to the [HCP
upload](/hcp/docs/vault-radar/cli/configuration/upload-results-to-hcp) page.

### Scan and restrict the number of secrets found

To stop scanning when the defined number of secrets are found.

```shell-session
$ vault-radar scan aws-s3 --bucket <BUCKET NAME> -r <REGION CODE> \
    -o <PATH TO OUTPUT>.csv \
    -l <NUM OF SECRETS>
```

### Scan and restrict the number of objects scanned

To stop scanning when the defined number of objects are scanned.

```shell-session
$ vault-radar scan aws-s3 --bucket <BUCKET NAME> -r <REGION CODE> \
    -o <PATH TO OUTPUT>.csv \
    --object-limit <NUM OF OBJECTS>
```
