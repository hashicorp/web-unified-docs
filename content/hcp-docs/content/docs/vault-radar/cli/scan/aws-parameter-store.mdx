---
page_title: scan aws-parameter-store command
description: |-
  The scan aws-parameter-store command is used for scanning parameters of type String and StringList in AWS Parameter Store.
---

# scan aws-parameter-store

@include 'beta-feature.mdx'

@include 'vault-radar/version-requirement.mdx'

The `scan aws-parameter-store` command is used for scanning parameters of type `String` and
`StringList` AWS Parameter Store.

<Note>

Parameters of type `SecureString` will not be scanned as they are secure by definition.

</Note>

## Authentication

The `scan aws-parameter-store` command needs permissions to read the parameter,
its history and tags, see the following simplified policy document. 

```json
{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Effect": "Allow",
            "Action": [
                "ssm:DescribeParameters",
                "ssm:GetParameterHistory",
                "ssm:GetParameter",
                "ssm:GetParameters",
                "ssm:ListTagsForResource"
            ],
            "Resource": "*"
        }
    ]
}
```

See [AWS Authentication](/hcp/docs/vault-radar/cli/configuration/aws-authentication) for
more information on how to authenticate with AWS.

## Usage

<CodeBlockConfig hideClipboard>

```plaintext
Usage: vault-radar scan aws-parameter-store [options]
```

</CodeBlockConfig>

### Command options

- `--region, -r`: Specifies the region of AWS Parameter Store to scan (required)
- `--outfile , -o`: Specifies the file to store information about found secrets (required)
- `--skip-history`: If specified, scans only the most recent version of the parameters. Default is to scan all available versions
- `--format, -f`: Specifies the output format, csv and json are supported. Defaults to csv
- `--index-file`: Specifies the index file path to use in order to determine which risks are Vaulted
- `--baseline, -b`: Specifies the file with previous scan results. Only new secrets will be reported.
- `--limit, -l`: Specifies the maximum number of secrets to be reported. The scan will stop when the limit is reached
- `--parameter-limit`: Specifies the maximum number of parameters to be scanned. The scan will stop when the limit is reached
- `--disable-ui`: Specifies that the scan summary should not be logged to stdout
- `--skip-activeness`: If specified, skips activeness checks

### Scan latest version of parameters

To scan latest version of all parameters within a region and write the results
to a CSV file (default format).

```shell-session
$ vault-radar scan aws-parameter-store -r <REGION CODE> \
    -o <PATH TO OUTPUT>.csv \
    --skip-history
```

### Scan latest version of parameters and output in JSON

To scan latest version of all parameters within a region and write the results
in [JSON Lines](https://jsonlines.org/) format

```shell-session
$ vault-radar scan aws-parameter-store -r <REGION CODE> \
    -o <PATH TO OUTPUT>.jsonl \
    --skip-history \
    -f json
```

### Scan all versions of parameters

To scan all the available versions of all parameters within a region

```shell-session
$ vault-radar scan aws-parameter-store -r <REGION CODE> \
    -o <PATH TO OUTPUT>.csv
```

### Scanning using a baseline file

Perform a scan using a previous scan's result and write the new changes to an
outfile. With `-b` option, only new risks, risks that were not found in the
previous scan will be reported.  

```shell-session
$ vault-radar scan aws-parameter-store -r <REGION CODE> \
    -b <PATH TO BASELINE>.csv \
    -o <PATH TO OUTPUT>.csv
```

Note: it is expected that previous and current scans are "similar", 
e.g. both either latest version or history scans and same output format

### Scanning using a Vault index file

Perform a scan using a generated vault index and write the results to an
outfile. In this mode, if a risk was previously found in Vault, the scan results
will report the location in Vault as well.

```shell-session
$ vault-radar scan aws-parameter-store -r <REGION CODE> \
    -o <PATH TO OUTPUT>.csv \
    --index-file <PATH TO VAULT INDEX>.jsonl
```

[How to generate a Vault Index](/hcp/docs/vault-radar/cli/index/vault#index-generation)

### HCP connection scanning behavior

The scan commands require an HCP cloud connection to ensure 
that hashes are generated using a shared salt from the
cloud keeping consistency across scans. In order to populate the HCP connection
information needed, refer to the [HCP
upload](/hcp/docs/vault-radar/cli/configuration/upload-results-to-hcp) page.

### Scan and restrict the number of secrets found

To stop scanning when the defined number of secrets are found

```shell-session
$ vault-radar scan aws-parameter-store -r <REGION CODE> \
    -o <PATH TO OUTPUT>.csv \
    -l <NUM OF SECRETS>
```

### Scan and restrict the number of parameters scanned

To stop scanning when the defined number of parameters are scanned.

```shell-session
$ vault-radar scan aws-parameter-store -r <REGION CODE> \
    -o <PATH TO OUTPUT>.csv \
    --parameter-limit <NUM OF PARAMETERS>
```
