---
page_title: scan tfe-variables command
description: |-
  The `scan tfe-variables` command is used for scanning non-sensitive variables in a HCP Terraform or Terraform Enterprise organization and identifying variable values that contain sensitive secrets.
---

# scan tfe-variables

@include 'beta-feature.mdx'

@include 'vault-radar/version-requirement.mdx'

The `scan tfe-variables` command is used for scanning non-sensitive variables in
an HCP Terraform (previously known as Terraform Cloud) or Terraform Enterprise
organization and identifying variable values that contain sensitive secrets. All
non-sensitive variables defined in Variable sets and Workspaces are scanned.
Both Terraform and Environment variables are scanned.

## Authentication

The `scan tfe-variables` command needs some authentication credentials in order
to be able to make requests to HCP Terraform or Terraform Enterprise.

### Terraform Enterprise (TFE)

In order to provide the information to `vault-radar`, specify the following
environment variables:

1. `TFE_ADDRESS`
1. `TFE_TOKEN`

### HCP Terraform

For HCP Terraform, use `https://app.terraform.io` as TFE_ADDRESS

## Usage

<CodeBlockConfig hideClipboard>

```plaintext
Usage: vault-radar scan tfe-variables [options]
```

</CodeBlockConfig>


The following examples all assume you have already set the appropriate
environment variable or that you intend to include them as part of the command
you run.

### Scanning variables in all workspaces

Scan all workspaces in an HCP Terraform or Terraform Enterprise organization and write the results to a file in
CSV format, this is the default format for output. 

```shell-session
$ vault-radar scan tfe-variables --org <TFE ORGANIZATION> \
    -o <PATH TO OUTPUT>.csv
```

### Scanning variables in all workspaces and output in JSON

Scan all workspaces in an HCP Terraform or Terraform Enterprise organization and write the results to a file in
[JSON Lines](https://jsonlines.org/) format.  

```shell-session
$ vault-radar scan tfe-variables --org <TFE ORGANIZATION> \
    -o <PATH TO OUTPUT>.jsonl \
    -f json
```

### HCP connection scanning behavior

The scan commands require an HCP cloud connection to ensure 
that hashes are generated using a shared salt from the
cloud keeping consistency across scans. In order to populate the HCP connection
information needed, refer to the [HCP
upload](/hcp/docs/vault-radar/cli/configuration/upload-results-to-hcp) page.

### Scanning using a Vault index file

Perform a scan using a generated vault index and write the results to an
outfile. In this mode, if a risk was previously found in Vault, the scan results
will report the location in Vault as well.

```shell-session
$ vault-radar scan tfe-variables --org <TFE ORGANIZATION> \
    -o <PATH TO OUTPUT>.csv \
    --index-file <PATH TO VAULT INDEX>.jsonl
```

[How to generate a Vault Index](/hcp/docs/vault-radar/cli/index/vault#index-generation)

### Scan and restrict the number of secrets found

Scan all workspaces in an HCP Terraform or Terraform Enterprise organization and write the results to an
outfile and stop scanning when the defined number of secrets are found.

```shell-session
$ vault-radar scan tfe-variables --org <TFE ORGANIZATION> \
    -o <PATH TO OUTPUT>.csv \
    -l <NUM OF SECRETS>
```
