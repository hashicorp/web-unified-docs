---
page_title: Add a data source - Slack
description: >-
  Add Slack as a data source for Vault Radar.
---

# Onboard a Slack data source.

HCP Vault Radar allows you to connect to any workspace on [Slack
](#onboard-slack) and scan for secrets in public channels.

## Prerequisites

- Permission in Slack to install third-party apps from the marketplace.

   <Highlight title="Known limitations">

   Vault Radar has a limit of 5000 channels per workspace. If you have more
   than 5000 channels, Vault Radar selects the 5000 channels with the
   most recent activity.

   </Highlight>

## Add a Slack Data source

1. Click **Settings/Data Sources**.

1. Select **HCP Vault Radar Scan**.

1. Under **Team Collaboration**, click **Slack**.
   ![Select Slack data source](/img/docs/vault-radar/slack-onboarding-flow.png)

1. Click **Connect to Slack** to **install the Slack app**. This initiates
   the OAuth flow with Slack.

1. Select the **Slack workspace** from the dropdown list and click **Allow**
   ![Install Slack App onto a workspace](/img/docs/vault-radar/install-slack-app-to-workspace.png)

   <Note title="Permission required to install Slack app">

   If you do not have permission to install apps into the selected workspace,
   you will see a **Submit Request** button instead of the **Allow** button.

   Coordinate with your Slack workspace administrator to approve the app
   installation.

   </Note>

   HCP Vault Radar displays the message **Authenticated to Slack**.

1. Click **Next**.

1. Select either **All active channels** or **Select channels to monitor**.

   The onboarding workflow joins the Slack app to the selected channels. If you
   have a large number of channels, this process will take several minutes to
   complete.

1. Click **Finish** to start onboarding and scanning the selected channels.

## Scan through an agent

## Prerequisites

### Create the Slack App

- To create a Slack app, [start by going to Slack's app creation page](https://docs.slack.dev/app-management/quickstart-app-settings) and click on **Create App**

### Requesting scopes for the Slack App
    
After the Slack app is created, we'll need to request scopes for your app. 
Scopes give the app permission to perform actions, such as reading Slack messages and replies.
To request scopes, open the  App and click on **OAuth & Permissions** in the app management page.
1. Within **OAuth & Permissions**, scroll down to Scopes.
1. Under **Bot Token Scopes**, Select **Add an OAuth Scope** and add the following scopes.
    ![Slack App OAuth Scopes](/img/docs/vault-radar/slack-oauth-scopes.png)

### Install and Authorize Slack App

Once the OAuth scopes are requested, the Slack app has to be installed onto the workspace to get the access token.

1. Open the Slack app and click on **OAuth & Permissions** section in the app management page
1. Install the Slack app by selecting the **Install to Workspace** button, under the section **OAuth Tokens**
1. The Slack OAuth flow will start. Select **Allow** on the following screen to continue to install the Slack app.

### Obtain Slack OAuth Bot Token

After installation, navigate back to the **OAuth & Permissions** page. A **Bot User OAuth Token** should be seen under the section **OAuth Tokens**.
Copy the **Bot User OAuth Token**

### Slack Signing secret

The signing secret is used to validate webhooks received from Slack (also called as Events in Slack terminology). 

To view and copy the signing secret:
1. Open the Slack app and click on the **Basic Information** section of the app management page
2. Click on the **Show** button in the Signing Secret field found on the right pane
3. Copy the value that will need to be entered in the **Enter Slack signing secret** text field

### Configuring the app for event listening

Slack apps listen and respond to events from your workspace. To enable webhooks for the Slack app, configure it to respond to events
such as when a message is posted to a channel or when a new channel is created.<br/><br/>
To configure the Slack app to respond to events

1. Open the Slack app and Select **Event Subscriptions** from the app management page
1. Toggle **Enable events** to ON
1. Within **Subscribe to bot events**, select **Add Bot user event** and subscribe to the below events

    ![Slack Events Subscribed](/img/docs/vault-radar/slack-events-subscribed.png)

2. Set the **Request URL** to a URL where the Vault Radar listens to the incoming HTTP requests.
The **Request URL** is `https://api.cloud.hashicorp.com/2023-05-01/vault-radar/projects/<hashicorp-project-id>/api/webhook-events/code-servers/slack-cloud?org=<slack-workspace>`
   - **project-id** will be available in the portal's URL, and **slack-workspace** is the slack workspace name on where the slack app is installed.

1. Wait for the **Request URL** to display as **Verified** 


## Add a Slack Data source

1. Select **Settings/Data Sources**.

1. Select **HCP Vault Radar Scan** and click **Continue**.

1. Under Team Collaboration, Click on the **Slack** button.

1. Enter the Slack workspace name in the **Enter your Slack Workspace name** text field.

1. Enter the Slack user OAuth access token in the **Enter your Slack user OAuth token** text field. Refer [here](#obtain-slack-oauth-bot-token)

1. Enter the Slack signing secret in the **Enter your Slack signing secret** text field. Refer [here](#slack-signing-secret)

1. Create an environment variable for the Slack OAuth user token in the agent environment. To copy the token, refer [here](#obtain-slack-oauth-bot-token)
   
   **Example:**

   <CodeBlockConfig hideClipboard>

   ```shell-session
   $ export SLACK_OAUTH_USER_TOKEN=<copy-token/>
   ```

   </CodeBlockConfig>

1. Enter the environment variable in the **Environment Path** text field with the `env://` prefix.
   
   Example:
   
   ```plaintext
   env://SLACK_OAUTH_USER_TOKEN

1. Click **Next**.

1. Once you establish a connection, select either **All active channels** or **Select channels to monitor** radio button.

1. Click **Finish**. The channels will now begin scanning
