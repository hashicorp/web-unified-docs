---
page_title: Vault Radar FAQ
description: |-
  Frequently asked questions and answers about Vault Radar.
---

# Vault Radar FAQ

This FAQ contains frequently asked questions about HCP Vault Radar.

- [Q: Why does Vault Radar use HMAC + Argon?](#why-use-hmac-argo)
- [Q: If both the database and the HMAC key are leaked, someone could launch a brute-force attack on the database?](#brute-force-attac)
- [Q: How do we calculate severity?](#q-how-do-we-calculate-severity)
- [Q: What are the explicit exclusions made by Vault Radar Secret Engine?](#exclusions)
- [Q: What IPs should be allowlisted for Vault Radar SaaS to scan data sources inside a user's network directly from HCP?](#ip-allowed-list)
- [Q: What firewall allowlisting is required for Vault Radar CLI and Agent to authenticate with HCP?](#firewall-allow-list)
- [Q: What secret hasher key is the offline Vault Radar CLI using?](#secret-hasher-key)

### Q: Why does Vault Radar use HMAC + Argon? ((#why-use-hmac-argon))

Argon2id is a [strong and secure hashing algorithm](https://www.latacora.com/blog/2018/04/03/cryptographic-right-answers/) providing memory-hardness, parallelism-safety, and adjustable parameters. It has undergone years of cryptographic testing and analysis, and is resistant to brute-force attacks due to the increased compute cost to crack.

To increase security, Vault Radar also uses [“peppering”](https://cheatsheetseries.owasp.org/cheatsheets/Password_Storage_Cheat_Sheet.html#peppering) on top of Argon2id hash. 

### Q: If both the database and the HMAC key are leaked, someone could launch a brute-force attack on the database? ((#brute-force-attack))

One of Argon2id's main features is resistance against brute force attacks. It is very expensive in both memory and CPU to attempt these types of attacks.

### Q: How do we calculate severity? 

The severity can be overridden by event rules for specific patterns, but this applies only to HCP scans and not CLI offline scans.

<table>
   <thead>
      <tr>
         <th style={{verticalAlign: 'middle'}}>Severity</th>
         <th style={{verticalAlign: 'middle'}}>Definitions</th>
      </tr>
   </thead>
   <tbody>
      <tr>
         <td><strong>Critical</strong></td>
         <td>
            <ul>
               <li>The risk category is secret, secret is active and secret is in the latest version of a data source.</li>
               <li>The risk category is secret, secret is active and secret is in the latest version of a secret manager.</li>
            </ul>
         </td>
      </tr>
      <tr>
         <td><strong>High</strong></td>
         <td>
            <ul>
               <li>This risk category is secret, secret is active and secret is not in the latest version of a data source.</li>
               <li>The risk category is secret, secret is in the latest version of a secret manager and its activeness cannot be determined.</li>
            </ul>
         </td>
      </tr>
      <tr>
         <td><strong>Medium</strong></td>
         <td>If none of the other conditions are met, the severity is set to medium by default.</td>
      </tr>
      <tr>
         <td><strong>Low</strong></td>
         <td>
            <ul>
               <li>The risk category is PII.</li>
               <li>The risk has certain tags (e.g., `secret_in_test_file`, `secret_in_example_file`).</li>
            </ul>
         </td>
      </tr>
      <tr>
         <td><strong>Info</strong></td>
         <td>
            <ul>
               <li>The risk category is NIL.</li>
               <li>The risk has certain tags (e.g., `ignore_rule`, `google_maps_api_key`, `inactive_secret`).</li>
               <li>The risk type is AwsAccessKeyId and is not active.</li>
            </ul>
         </td>
      </tr>
   </tbody>
</table>

### Q: What are the rules to assign secret_in_test_file tag? ((#tag-secret_in_test_file))

- the file or (sub)directory name of the file where the risk is located contains "test".
- the (sub)directory name of the file where the risk is located starts with "mocks".
- the (sub)directory name of the file where the risk is located is "qa".

### Q: What are the explicit exclusions made by Radar Secret Engine? ((#exclusions))

- Keys and IDs containing EXAMPLE or TEST are not reported at all.
- README files are marked as not important.
- Test files are marked as not important.

### Q: What IPs should be allowlisted for Vault Radar SaaS to scan data sources inside a user's network directly from HCP? ((#ip-allowed-list))

Users will need to allow inbound access from the following IP addresses in order for Vault Radar HCP to communicate with data sources within a secure network.

```plaintext
# Vault Radar Primary
3.213.172.245
44.215.93.123
34.226.175.235

# Vault Radar Failover
34.208.33.38
44.227.97.170
44.238.204.12
```

<Note>

There may be changes to these IP’s in the future, HashiCorp (Vault-Radar) will do its best to give customers a reasonable amount of time to make the necessary changes.

</Note>

### Q: What firewall allowlisting is required for Vault Radar CLI and Agent to authenticate with HCP? ((#firewall-allow-list))

If outbound traffic is restricted from within a user's network, then following fully qualified domain names (FQDNs) should be allowed in order for the Vault Radar Agent and/or CLI to communicate with HCP.

```plaintext
api.cloud.hashicorp.com
auth.idp.hashicorp.com
```

<Note>

HashiCorp HCP does not have a predefined set of static IP’s for ingress traffic to its servers at this time.

</Note>

### Q: What secret hasher key is the offline Vault Radar CLI using? ((#secret-hasher-key))

Because the CLI is offline it cannot contact HCP to retrieve the project's secret hasher key. The CLI sets and creates it's own key to be reused in subsequent scans for consistency. The configuration is saved at: `$HOME/.vault-radar.json` with key `"secret_hasher_key"`. Example:

```json

{"secret_hasher_key":"LaTuHNZD/QFXGjuKcKYthNUGp6zwrqy/86R824tyfRU"}

```