Vault provides a [Kubernetes authentication](/vault/docs/auth/kubernetes) method
that lets clients authenticate with Kubernetes `ServiceAccount` tokens. With
Kubernetes authentication, Vault accepts service tokens from clients within
the Kubernetes cluster and verifies the service account token by querying a
token review Kubernetes endpoint.


1. If you closed the previous interactive shell session, use the Kubernetes CLI
   to start a new session on the first pod (`vault-0`):

   ```shell-session
   $ kubectl exec --stdin=true --tty=true vault-0 -- /bin/sh
   / $
   ```

1. Use the Vault CLI in your interactive session to enable the Kubernetes
   authentication plugin on the default path:

   ```shell-session
   $ vault auth enable kubernetes
   ```

1. Use the Vault CLI in your interactive session to configure the `kubernetes/`
   plugin to use the Kubernetes API to validate `ServiceAccount` tokens using
   the identity of the pod:

   ```shell-session
   $ vault write auth/kubernetes/config \
      kubernetes_host="https://${KUBERNETES_PORT_443_TCP_ADDR}:443"
   ```

1. Use the Vault CLI in your interactive session to write out a policy that lets
   clients read any required secrets. For example, to create a policy called
   `devwebapp` that lets clients read credentials from the `kv` path
   `creds/devapp`:

   ```shell-session
   $ vault policy write devwebapp - <<EOF
   path "creds/data/devapp" {
      capabilities = ["read"]
   }
   EOF
   ```

1. Use the Vault CLI in your interactive session to create a cooresponding
   Kubernetes authentication role that uses the new policy. For example, to
   create an authentication role called `devweb-app` that uses the `devwebapp` policy:

   ```shell-session
   $ vault write auth/kubernetes/role/devweb-app   \
         bound_service_account_names=internal-app  \
         bound_service_account_namespaces=default  \
         policies=devwebapp                        \
         ttl=24h
   ```

The authentication role connects the Kubernetes service account named in
`bound_service_account_names` to the Vault policy named in `policies`.