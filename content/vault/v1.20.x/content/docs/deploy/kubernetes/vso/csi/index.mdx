---
layout: docs
page_title: Direct secrets
description: >-
  Mount secrets from Vault directly into application containers with the Vault
  Secrets Operator CSI driver.
---

# Direct secrets

@include 'alerts/enterprise-only.mdx'

While the Vault Secrets Operator lets you store Vault secrets in clusters as native
Kubernetes Secrets, you can also use the "direct secrets" feature to mount Vault secrets directly to containers as Kubernetes [ephemeral volumes](https://kubernetes.io/docs/concepts/storage/ephemeral-volumes/).

The direct secrets feature installs the Vault Secrets
Operator [CSI](https://github.com/container-storage-interface/spec/blob/master/spec.md) driver. 
The CSI driver hooks into the Pod volume lifecycle, allowing applications to store secret data from Vault in ephemeral volumes with the same lifecycle as the application Pod itself.

The Vault Secrets Operator CSI driver supports:
- Syncing multiple secrets from multiple plugins. Supported plugins include:
  - [Key/Value v1](/vault/docs/secrets/kv/kv-v1)
  - [Key/Value v2](/vault/docs/secrets/kv/kv-v2)
- Automatic generation and mounting of response-wrapped AppRole secret IDs as a
  [trusted orchestrator](/vault/tutorials/app-integration/secure-introduction?in=vault%2Fapp-integration#trusted-orchestrator) for authentication between application Pods and Vault.
- Helm-based [installation](/vault/docs/platform/k8s/vso/installation).
- [Secret data transformation](/vault/docs/platform/k8s/vso/secret-transformation).

The Vault Secrets Operator CSI driver does not support the [instant updates](/vault/docs/deploy/kubernetes/vso/sources/vault/instant-updates) feature.
KV secret information updates whenever either new requesting Pods come online, or a container in a requesting Pod crashes or exits. 
Otherwise, application containers must self-restart to receive updated secret information after a secret is updated in Vault. 

To learn how to set up the direct secrets functionality, refer to the [setup](/vault/docs/platform/k8s/vso/csi/setup) page.

## Secrets flow: Traditional VSO vs CSI driver

In the traditional workflow, the Vault Secrets Operator caches Vault secrets as Kubernetes Secrets, which are stored in etcd. 
The Vault Secrets Operator watches for changes to custom resources such as [VaultStaticSecret](/vault/docs/platform/k8s/vso/api-reference#vaultstaticsecret) or [VaultDynamicSecret](/vault/docs/platform/k8s/vso/api-reference#vaultdynamicsecret). 
When the resource definition changes, Vault Secrets Operator overwrites secret data in the associated Kubernetes Secret with the new information.

[![Diagram showing a secret flowing from Vault, through VSO, into the associated Kubernetes Secrets objects across all nodes in an app namespace](/img/vso_secrets_flow.png)](/img/vso_secrets_flow.png)

In the CSI driver workflow, the driver does not cache secrets as Kubernetes Secrets, so there is no storage in `etcd`.
The driver watches for changes to a custom resource (CR) called `CSISecrets`. The
[CSISecrets](/vault/docs/deploy/kubernetes/vso/api-reference#csisecrets) resource
contains a declarative list of secrets to fetch and an access control
configuration that only allows the designated Pods to mount those secrets.
When the spec of an approved Pod references the `CSISecrets` resource as a volume to mount, the Vault Secrets Operator CSI driver populates 
that volume with the associated secrets for all referencing containers in the Pod.

The Pod starts up with all of the secrets from the `CSISecrets` resource mounted
at the configured path (for example, `/var/run/csi-secrets`) as individual files.
The driver indexes each file with a number representing its position in the
`vaultStaticSecrets` or `vaultAppRoleSecretIDs` list, starting at 0. For example,
`static_secret_0_secret`, `static_secret_1_secret`, ..., `static_secret_N_secret`.

[![Diagram showing a secret flowing directly from Vault, through the CSI driver on a Kubernetes node, and into the associated volume to all nodes in an app namespace](/img/vso_csi_secrets_flow.png)](/img/vso_csi_secrets_flow.png)