#### List parameter evaluation

When a request parameter carrying a list value matches an
`allowed_parameters` or `denied_parameters` policy rule, Vault checks for
an exact match between each allowed or denied value in the policy and
the **entire** list value in the request parameter. The fact that Vault
looks for matches to the entire list can produce unexpected results.

For example, if you set `allowed_parameters` to `"X": ["A", "B"]`:

- Vault only allows requests with parameter `"X": "A"` or `"X": "B"`.
- Vault denies all other requests. . For example, Vault denies
   requests with parameter `"X": ["A", "B"]`, `"X": ["B", "A"]` or
   even `"X": ["A"]`, because the parameter value does not
   **exactly** match one of the allowed values ("A" or "B").

The same logic applies to `denied_parameters`. If you create a policy with
`denied_parameters` set to `"Y": ["C", "D"]`:

- Vault only denies requests with parameter `"X": "C"` or `"X": "D"`.
- Vault allows all other requests. For example, Vault allows requests with
   parameter `"Y": ["C", "D"]`, which can lead to unauthorized access if you
   intended to deny any request that included "C", "D", or both.

As a result, we **strongly recommend** using `allowed_parameters`
instead of `denied_parameters` for list parameters.

Additionally, Vault does not treat comma-separated strings in request
parameters as lists when evaluating `allowed_parameters` and `denied_parameters`.
For instance, configuring `denied_parameters` as `"Z": ["C", "D", ["C"], ["D"], ["C", "D"], ["D", "C"]]`
does not block requests that set `"Z": "C,D"` or `"Z": "D,C"`

<Tip title="Consider upgrading to 1.21.x or later">

Vault addressed the unexpected behavior of
`allowed_parameters` and `denied_parameters` in 1.21.x with
more intuitive list processing.

</Tip>
