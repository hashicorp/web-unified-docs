### JWT auth login requires bound audiences on the role

#### Affected versions

- 1.15.9
- 1.15.10
- 1.16.3
- 1.16.4

#### Issue

A behavior change was introduced in the **JWT auth plugin** to address **CVE-2024-5798**.
Because this change introduced breaking behavior, it was **reverted** in versions **after 1.15.10 and 1.16.4**.
However, the change was **reintroduced in version 1.17+**.

The updated behavior enforces stricter validation of the `bound_audiences` parameter in JWT roles.

- The `bound_audiences` parameter **must** match at least one of the JWT’s `aud` (audience) claims.
- The `aud` claim can be a single string or an array of strings, as defined in
[RFC 7519 Section 4.1.3](https://datatracker.ietf.org/doc/html/rfc7519#section-4.1.3).

Once a JWT is confirmed to be properly signed and not expired, Vault performs additional authorization checks to ensure that configured “bound”
parameters match the corresponding claims in the token.

For **roles of type `jwt`**:

- The `bound_audiences` parameter is **required** when an `aud` claim is present.
- The value of `bound_audiences` must **exactly match** at least one of the provided `aud` claims.

Additionally, roles can validate arbitrary claim values using the `bound_claims` map.

```json
{
  "division": "Europe",
  "department": "Engineering"
}
```

Only JWTs containing both the "division" and "department" claims, and respective matching values of "Europe" and "Engineering", would be authorized.
If the expected value is a list, the claim must match one of the items in the list. To limit authorization to a set of email addresses:

```json
{
  "email": ["fred@example.com", "julie@example.com"]
}
```

For additional details, refer to the
[JWT auth method (API)](/vault/api-docs/auth/jwt) documentation.

See this [issue](https://github.com/hashicorp/vault/issues/27343) for more details.

#### Workaround

Configure the `bound_audiences` parameter of "jwt" roles to match at least one
of the JWT's associated `aud` claims. This configuration will be required for
1.17 and later.
