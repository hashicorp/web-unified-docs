---
layout: docs
page_title: Configuration
description: >-
Configuration parameters for the Vault Kubernetes KMS v2 provider.
---

# Configuration

This page documents the configuration parameters for the Vault Kubernetes KMS v2
provider. These parameters control how the provider exposes its KMS v2 gRPC
endpoint to Kubernetes, connects to Vault, authenticates, selects a Transit key,
and emits logs and metrics.

Configuration is provided to the provider at startup using command-line flags.
The provider validates configuration on startup and exits if required parameters
are missing or invalid.

---

## Parameters

- `listen-address` `(string: <required>)` –
The Unix domain socket address where the provider listens for requests from the
Kubernetes API server. The kube-apiserver must have filesystem access to this
socket in order to communicate with the provider.

This value must be a non-empty string.

- `vault-address` `(string: <required>)` –
The HTTP(S) API address of the Vault server. The provider connects to this
address to authenticate and perform cryptographic operations using the Vault
Transit secrets engine.

This value must be a non-empty string and must be reachable from the node where
the provider runs.

- `vault-namespace` `(string: nil)` –
The Vault namespace in which the provider operates. If unset, the provider uses
the root namespace.

This parameter is required when using Vault Enterprise with namespaces enabled.

- `transit-mount` `(string: <required>)` –
The mount path of the Vault Transit secrets engine used by the provider to
encrypt and decrypt data encryption keys (DEKs).

This value must be a non-empty string and must reference an existing Transit
mount in Vault.

- `transit-key-name` `(string: <required>)` –
The name of the Vault Transit key used by the provider to encrypt and decrypt
DEKs. The key must already exist in Vault.

The provider’s Vault policy must grant permission to use this key for encryption
and decryption operations.

- `auth-method` `(string: <required>)` –
The Vault authentication method used by the provider.

Supported values:
- `approle`

---

## Authentication parameters

### Approle

When using Approle, the following parameters are required.

- `approle-role-id` `(string: <required>)` –
The AppRole Role ID used to authenticate to Vault. This value is not sensitive
and can be provided directly as a flag.

- `approle-secret-id-path` `(string: <required>)` –
The filesystem path to a file containing the AppRole Secret ID. This value is
sensitive and should be protected using appropriate filesystem permissions.

The provider reads the Secret ID from this file at startup.

---

## Logging parameters

- `log-level` `(string: "info")` –
Configures the provider’s logging behavior using Zap logging levels.

Supported values are:

- `debug`
- `info`
- `warn`
- `error`

The provider uses Zap for structured logging. Setting a more verbose level
(such as `debug`) enables additional diagnostic fields and internal execution
details, which may be useful for troubleshooting but can increase log volume.

---

## Metrics and telemetry parameters

- `metrics-port` `(int: nil)` –
The local TCP port where the provider exposes a Prometheus-compatible
`/metrics` endpoint. The endpoint binds to `localhost`.

If unset, the provider does not expose a metrics endpoint.

- `enable-runtime-metrics` `(bool: false)` –
Controls whether Go runtime and process-level metrics are exposed alongside
provider metrics.

When enabled, the `/metrics` endpoint includes metrics such as garbage
collection statistics, goroutine counts, and memory usage.

---

## Minimal configuration example

```text
--listen-address=/var/run/kms/vault-kms.sock
--vault-address=https://vault.example.com:8200
--transit-mount=transit
--transit-key-name=kubernetes-etcd
--auth-method=approle
--approle-role-id=example-role-id
--approle-secret-id-path=/var/run/secrets/vault/secret-id
```
