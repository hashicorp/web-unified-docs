---
layout: docs
page_title: Vault Kubernetes KMS v2 provider
description: Use the Vault Kubernetes KMS v2 provider to encrypt Kubernetes data at rest with Vault Enterprise.
---

# Vault Kubernetes KMS v2 provider

The Vault Kubernetes KMS v2 provider is a Kubernetes KMS v2 plugin that lets Kubernetes use
Vault Enterprise for encryption at rest.The Kubernetes API server encrypts and decrypts data
encryption keys (DEKs) by calling Vault, rather than storing key encryption keys (KEKs) in the
cluster.

The plugin runs alongside the Kubernetes control plane and exposes a KMS v2–compatible gRPC
endpoint that the API server uses for envelope encryption.

## How it works

When Kubernetes enables KMS encryption or rotates keys, the **kube-apiserver** encrypts data
encryption keys (DEKs) by calling the plugin’s Encrypt method.

During kube-apiserver startup, the API server calls the plugin’s Decrypt method to decrypt
previously encrypted DEKs.

The plugin forwards these requests to **Vault (typically the Transit engine)** to perform
cryptographic operations on the DEKs. The API server encrypts resource data locally using the
DEKs and stores the encrypted DEKs in etcd, while Vault retains cryptographic authority over
key encryption.

For details on configuring a KMS v2 plugin and the KMS v2 API, refer to the
[Kubernetes KMS provider documentation](https://kubernetes.io/docs/tasks/administer-cluster/kms-provider/).

## Use cases

**Encrypt Kubernetes secrets at rest:** Protect secrets stored in etcd with Vault-backed encryption
without changing application code.

**Centralize key management and policy:** Manage encryption keys and access policies in Vault, with
centralized auditing and RBAC enforcement.

**Support key rotation workflows:** Rotate keys in Vault and the plugin while preserving the ability
to decrypt existing data.

**Improve operational visibility:** Inspect key usage, latency, and errors using Vault audit logs and
plugin logs and metrics.

@include 'kubernetes-supported-versions.mdx'

## Supported Kubernetes distributions

The plugin has been validated on the following Kubernetes distributions:

- Red Hat OpenShift

The plugin also supports self-managed Kubernetes distributions, as long as the Kubernetes
control plane can reach the KMS v2 gRPC endpoint.
