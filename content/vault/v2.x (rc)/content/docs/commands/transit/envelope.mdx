---
layout: docs
page_title: transit envelope - Commands
description: |-
  The "transit envelope encrypt" and "transit envelope decrypt" commands 
  facilitate the encryption and decryption of files and streams client side.
  "transit envelope header" displays an encrypted file header.
---

# transit envelope

The `transit envelope` commands use Vault Transit (Enterprise) to create
envelope encryption keys that the command uses to encrypt and decrypt
files and streams of arbitrary size without transiting the plaintext to
Vault.  All encryption and decryption happens on the caller's side.

The caller must have write permissions to the transit mount's `datakeys` and 
`derivedkeys` endpoints to generate DEK/EDK pairs.

## Examples

Encrypt a multi-terabyte file using `envelope encrypt`:

```
$ vault transit envelope encrypt transit/keys/test-key really-big-file.zip
```

Decrypt the result, saving the output in a second file:

```
$ vault transit envelope decrypt -o really-big-file2.zip transit/keys/test-key really-big-file.zip.vee
```

## Usage

This command respects core Vault CLI command options.

### Encrypt 

 See `vault envelope encrypt -help` for more information.

This command at least two positional arguments:

 1. `PATH`, the path to the transit key to use for DEK/EDK generation in the format of
    `<mount>/keys/<key-name>`, where `<mount>` is the path to the mount
    (using `-namespace=<ns>` to specify any namespaces), and `<key-name>`
    is the desired name of the key.
    By default, encrypted files will be output to the input file name plus
    `.vee` (**V**ault **E**nvelope **E**ncrypted)
 2. One or more filenames to encrypt OR `-` to encrypt input from stdin.

The following option flags can be specified:

* --quiet (-q): Display no output unless there is an error.
* --output (-o) <file>: Output to the specified file.  Can only be used if there 
  is a single input.
* --suffix (-s) <suffix>: Append <suffix> to output file names.
* --metadata <base64|@file>: Additional metadata that will be added to the file
but not encrypted.  It can be retrieved without decryption, and without access 
to the Transit key management endpoints.  Metadata is in JSON format, either
base64 encoded as the argument to the flag, or read from <file> if specified 
as @file.
* --aad <base64|@file>: Additional authenticated data.  This is either a base64
encoded binary blob, or is read from <file> if specified as @file.  Additional 
authenticated data is added to the authentication present in the output.  
Decryption will fail if the aad supplied at decrypt is absent or different.

### Decrypt 

 See `vault envelope decrypt -help` for more information.

This command at least two positional arguments, as in encrypt. By default, 
if the input file ends in `.vee`, the output file will be the input file name
minus that suffix.  

The quiet, suffix, output, and aad flags from encrypt can be used in decrypt.
AAD must match that given during encrypt or decryption will fail.

### Header

See `vault envelope header -help` for more information.

This command takes one or more files or streams, and outputs the header, including
any metadata provided at encrypt time.  The standard `-format` flag is useful
for consuming the result programatically.