---
page_title: Upgrade Terraform Enterprise
description: Learn how to upgrade Terraform Enterprise using Docker Compose and Helm to run new versions on Nomad, Kubernetes, OpenShift, Podman, or Docker.
---

# Upgrade Terraform Enterprise

This topic describes how to upgrade Terraform Enterprise installations. 

## Introduction

We recommend upgrading in a test environment first before upgrading the production instance of Terraform Enterprise.

## Plan your upgrade

Complete the following tasks before you schedule downtime:

- **Required — Confirm compatibility**: Identify the Terraform Enterprise version you plan to install. Compare the supported platforms and dependency versions in the [release tables](/terraform/enterprise/releases) with your current infrastructure. Review the release notes for the target version and every intermediate version for breaking changes, deprecations, and new requirements.
- **Required — Map required releases**: Use the "Last required release" marker on the target version page (for example, [Terraform Enterprise 1.1.x](/terraform/enterprise/releases/1.1.x)) to determine which previous releases you must install first. Repeat this comparison for each required release until you reach your current running version. Document the sequence so you know which packages to stage. See the [Example upgrade path](#example-upgrade-path) for a sample workflow.
- **Required — Prepare the environment**: 
  - Freeze automation that could start runs.
  - Notify stakeholders.
  - Verify that operating system, PostgreSQL, Redis, and container runtime versions are supported.
  - Prune unused images or volumes to free capacity. *(Docker, Podman)*
- **Required — Back up and stage rollback assets**: 
  - Create fresh snapshots of external services, including PostgreSQL, object storage, and Redis.
  - Download required application images for each release in your upgrade path.
  - Define the conditions that trigger a rollback.
  - Verify that you can restore data and configuration quickly if the upgrade fails.
- **Recommended — Test the upgrade path**: Rehearse the full sequence in a test environment that mirrors production. Validate that required releases install cleanly, dependencies meet the target version requirements, and automation resumes as expected after the upgrade.

### Example upgrade path

The following scenario shows how to build an upgrade path from a monthly release to a milestone release:

1. Your production environment runs Terraform Enterprise `v202401-1`.
1. Your target version is Terraform Enterprise `1.1.0`.
1. Visit the [Terraform Enterprise 1.1.x releases page](/terraform/enterprise/releases/1.1.x) and note that `1.1.0` lists `v202406-1` as the last required release.
1. Visit the [Terraform Enterprise 2024 releases](/terraform/enterprise/releases/2024/v202406-1) page. `v202406-1` requires no earlier release, so your full upgrade sequence is `v202401-1` → `v202406-1` → `1.1.0`.
1. Stage the images and release notes for each hop. Use the planning checklist at the end of this topic to coordinate backups, notifications, and testing before you promote the upgrade to production.

## Execute the upgrade

After you complete the planning tasks, perform the following steps to upgrade Terraform Enterprise. The specific commands vary by runtime, but the overall process remains the same.
Review the runtime-specific instructions in the following tabs.
<Note>

OpenShift users should follow the instructions in the **Helm Chart** tab, as OpenShift deployments use Helm for application management.

</Note>

1. Back up your Terraform Enterprise data. Refer to [Backup and restore](/terraform/enterprise/deploy/manage/backup-restore) for instructions.

1. Use the Terraform Enterprise CLI to stop any existing Terraform runs and prevent Terraform Enterprise from starting new operations. Draining nodes allows active runs to complete before blocking new work. Refer to [Gracefully stop work on a node](/terraform/enterprise/deploy/reference/cli#gracefully-stop-work-on-a-node) for instructions.

1. If your deployment runs multiple `terraform-enterprise` nodes in active-active mode, scale down to a single node to ensure upgrade consistency. Refer to [Configure the operational mode](/terraform/enterprise/deploy/configuration/storage/configure-mode) for information about operational modes.

   <Note>

   The method for scaling down varies by runtime:
   - **Kubernetes/Helm**: Set `replicaCount: 1` in your values file
   - **Docker Compose**: Stop additional service instances or update the compose file
   - **Nomad**: Update the job specification's `count` to 1
   - **Podman**: Stop additional pods or containers

   After the upgrade completes and you validate the application, scale back to your desired replica count.

   </Note>

1. If your deployment uses an autoscaling group to manage instances of Terraform Enterprise, disable any configured health checks that would trigger the autoscaling group to rotate Terraform Enterprise instances during an upgrade.

   <Note>

   This step applies to orchestrated environments (Kubernetes, Nomad, OpenShift) where the platform manages instance health and automatic replacement. Skip this step if you use Docker Compose or standalone Podman deployments.

   </Note>

1. Stop the Terraform Enterprise application.

  <Tabs>
    <Tab heading="Docker Compose" group="first">

    Stop all running containers:

    ```shell-session
    $ docker compose down
    ```

    </Tab>
    <Tab heading="Helm Chart" group="second">

    Scale down the deployment by setting the replica count to zero in your `values.yaml` file:
    
    ```yaml
    replicaCount: 0
    ```

    </Tab>
    <Tab heading="Podman" group="third">

    Stop the pod defined in your Kubernetes YAML:

    ```shell-session
    $ podman kube play --down <path_to_YAML_file>
    ```

    </Tab>
    <Tab heading="Nomad" group="fourth">

    Stop the Terraform Enterprise job:

    ```shell-session
    $ nomad job stop <tfe-job-name>
    ```

    </Tab>
  </Tabs>

1. Pull the new Terraform Enterprise image for a specific [release](/terraform/enterprise/releases): `images.releases.hashicorp.com/hashicorp/terraform-enterprise:vYYYYMM-#`.

  <Tabs>
    <Tab heading="Docker Compose" group="first">

    Update the image tag in your `compose.yaml` file:

    ```yaml
      name: terraform-enterprise
      services:
        tfe:
          image: images.releases.hashicorp.com/hashicorp/terraform-enterprise:<vYYYYMM-#>
    ```

    </Tab>
    <Tab heading="Helm Chart" group="second">

    Update your `values.yaml` file with the new image tag and restore the replica count:

    ```yaml
      replicaCount: 1
      image:
      repository: images.releases.hashicorp.com
      name: hashicorp/terraform-enterprise
      tag: <vYYYYMM-#>
    ```

    </Tab>
    <Tab heading="Podman" group="third">

    Update the image tag in your `kube.yaml` file:

    ```yaml
      spec:
        image: "images.releases.hashicorp.com/hashicorp/terraform-enterprise:<vYYYYMM-#>"
        name: "terraform-enterprise"
    ```

    </Tab>
    <Tab heading="Nomad" group="fourth">

    Update the image tag in your Nomad job specification file:

    ```hcl
      variable "tfe_image" {
        description = "The TFE image to use"
        type        = string
        default     = "images.releases.hashicorp.com/hashicorp/terraform-enterprise:<vYYYYMM-#>"
      }
    ```

    </Tab>
  </Tabs>

1. Start the Terraform Enterprise application with the new image. Database migrations run automatically during startup and may take considerable time depending on your deployment size and the migrations required for the target release. The application remains unavailable until migrations finish.

  <Tabs>
    <Tab heading="Docker Compose" group="first">

    Start the containers with the updated image:

    ```shell-session
    $ docker compose up --detach
    ```

    </Tab>
    <Tab heading="Helm Chart" group="second">

    Apply the updated configuration using Helm:

    ```shell-session
    $ helm -n <TFE_NAMESPACE> upgrade --values=<OVERRIDES_FILE> terraform-enterprise hashicorp/terraform-enterprise
    ```

    </Tab>
    <Tab heading="Podman" group="third">

    Start the pod with the updated configuration:

    ```shell-session
    $ podman kube play <path_to_YAML_file>
    ```

    </Tab>
    <Tab heading="Nomad" group="fourth">

    Deploy the updated job specification:

    ```shell-session
    $ nomad job run \
      -var="tfe_image_username=$TFE_REGISTRY_USERNAME" \
      -var="tfe_image_password=$TFE_REGISTRY_PASSWORD" \
      <path-to-tfe-job-spec>
    ```

    </Tab>
  </Tabs>

1. If you performed the upgrade in a test environment, repeat steps 1-7 for the production instance of Terraform Enterprise.

## Validate the upgrade

After Terraform Enterprise starts on the new version, perform the following checks:

1. **Verify startup checks passed**. Use the Terraform Enterprise CLI to trigger and review startup checks. Refer to [Trigger startup checks](/terraform/enterprise/deploy/reference/cli#trigger-startup-checks) for instructions on running the checks and [Startup checks reference](/terraform/enterprise/deploy/reference/startup-checks) for details about each check and common failure scenarios.

1. **Check application health**. Query the health check endpoint to verify the application responds correctly. The endpoint returns `200 OK` when Terraform Enterprise operates normally. Refer to [Perform diagnostics](/terraform/enterprise/deploy/troubleshoot/perform-diagnostics#run-a-health-check) for additional information about the health check endpoint.

   ```shell-session
   $ curl https://<TFE_HOSTNAME>/_health_check
   ```

1. **Perform a test run**. Execute a test Terraform plan and apply in a non-production workspace to confirm core functionality.

1. **Verify release-specific features**. Confirm that features or fixes from the target release appear as expected. Consult the release notes for validation steps.

1. **Re-enable paused systems**. Restore automation, autoscaling configurations, and monitoring that you paused during the upgrade. For active-active deployments, scale back to your desired replica count.

1. **Document the upgrade**. Record the upgrade path, any issues encountered, and resolution steps for future reference.

### Troubleshoot validation failures

If any validation step fails or the application does not stabilize:

1. Pause automated traffic and notify stakeholders.
1. Review application logs for migration errors or dependency mismatches. Refer to [Access the Terraform Enterprise CLI](/terraform/enterprise/deploy/manage/access-cli) for instructions on accessing logs in your environment.
1. If the issue persists beyond your change window, initiate rollback:
   1. Stop the Terraform Enterprise application.
   1. Restore PostgreSQL from the pre-upgrade snapshot.
   1. Restore object storage from the pre-upgrade snapshot.
   1. Deploy the previous Terraform Enterprise image version.
   1. Verify the application starts successfully.
1. Contact [HashiCorp Support](https://support.hashicorp.com/hc/en-us) with collected logs, the upgrade path attempted, and error messages for assistance.

## Quick planning checklist

- Target version selected and compatibility verified
- Required release sequence documented
- Maintenance window scheduled and change tickets approved
- Configuration captured
- Backups completed for PostgreSQL, Redis, and object storage
- New container images downloaded for each hop
- Rollback criteria defined and restore procedure rehearsed
- Test upgrade rehearsal completed (recommended)
- Stakeholders notified and monitoring paused as needed

If you encounter issues at any point, contact [HashiCorp Support](https://support.hashicorp.com/hc/en-us) with your upgrade plan, release sequence, and the relevant logs.
