---
page_title: 'State: Sensitive Data'
description: Sensitive data in Terraform state.
---

# Sensitive Data in State

Terraform state can contain sensitive data, depending on the resources in use
and your definition of "sensitive." Unless your variables or resources are `ephemeral`, the state contains resource IDs and all resource attributes. For resources such as databases, this can contain initial
passwords.

When using local state, state is stored in plain-text JSON files.

When using [remote state](/terraform/language/state/remote), state is only ever held in memory when used by Terraform. It may be encrypted at rest, but this depends on the specific remote state backend.

## Ephemerality

Terraform supports ephemerality for specific configuration blocks. Ephemeral values are available at run time, but Terraform omits them from state and plan files. Ephemerality helps when you manage credentials, tokens, or other temporary resources that you do not want to store in Terraform state files.

The following configuration blocks support ephemerality:
- Managed `resource` blocks support ephemeral [write-only arguments](/terraform/language/resources/ephemeral/write-only)
- Providers support ephemeral resources using [`ephemeral` blocks](/terraform/language/block/ephemeral)
- Add the `ephemeral`  argument on a [`variable` block](/terraform/language/block/variable#ephemeral)
- Add the `ephemeral`  argument on a [`output` block](/terraform/language/block/output#ephemeral)


You can only refer to values with the `ephemeral` property in specific contexts or Terraform throws an error when you plan your changes. The following are valid ephemeral contexts:

- In a managed resource [write-only argument](/terraform/language/resources/ephemeral/write-only)
- In an [`ephemeral` block](/terraform/language/block/ephemeral)
- In the [`locals` block](/terraform/language/values/locals#ephemeral-values)
- In [variables with the `ephemeral` argument](/terraform/language/block/variable#ephemeral)
- In [outputs with the `ephemeral` argument](/terraform/language/block/output#ephemeral)
- Configuring [providers in the `provider` block](/terraform/language/functions/terraform-applying)
- In [provisioner](/terraform/language/resources/provisioners/syntax) and [connection](/terraform/language/resources/provisioners/connection) blocks


### Ephemeral resources

The `ephemeral` block declares a temporary ephemeral resource that only exists during the current Terraform operation. Terraform does not store ephemeral resources in state or plan files, making them ideal for managing sensitive or temporary data that you do not want to persist, such as temporary passwords or connections to other systems.

To learn more about the `ephemeral` resource block, refer to [the `ephemeral` block reference](/terraform/language/block/ephemeral).


#### Lifecycle

Ephemeral resources have a unique lifecycle compared to regular resources and data sources. Terraform performs the following lifecycle steps for each ephemeral resource:
1. Terraform opens an ephemeral resource if it needs access to the resource’s result.
1. Terraform asks the ephemeral resource’s provider to periodically renew access if it needs to access the resource for longer than the remote system's enforced expiration time.
1. Terraform closes the ephemeral resource after the providers that depend on that resource complete their work for the current run phase.

As an example, if your Terraform configuration defines an ephemeral resource for a Vault secret, Terraform begins by opening the resource by having the Vault provider obtain a lease and return the secret. If needed, Terraform renews the resource by calling Vault's lease renewal API endpoint to extend the expiration time. Finally, Terraform closes the resource by explicitly ending the lease, letting Vault immediately revoke the associated credentials.


#### Order of provisioning

Ephemeral resources form nodes in Terraform's dependency graph and interact similarly to resources and data sources. When a resource or data source depends on an attribute of an ephemeral resource, Terraform automatically provisions the ephemeral resource first.

If an input argument of an ephemeral resource references a value that Terraform does not know yet but can learn during or after a plan, Terraform defers executing that resource until the apply stage.

## Recommendations

Treat the state as sensitive data if you manage secret credentials like database passwords, user passwords, or private keys with Terraform. You can also mark your sensitive data in variables as `ephemeral` to prevent Terraform from writing those variables to your state and plan files.

Storing state remotely can provide better security. As of Terraform 0.9,
Terraform does not persist state to the local disk when remote state is in use,
and some backends can be configured to encrypt the state data at rest.

For example:

- [HCP Terraform](https://cloud.hashicorp.com/products/terraform) always encrypts state at rest and
  protects it with TLS in transit. HCP Terraform also knows the identity of
  the user requesting state and maintains a history of state changes. This can
  be used to control access and track activity. [Terraform Enterprise](/terraform/enterprise)
  also supports detailed audit logging.
- The S3 backend supports encryption at rest when the `encrypt` option is
  enabled. IAM policies and logging can be used to identify any invalid access.
  Requests for the state go over a TLS connection.
- The GCS (Google Cloud Storage) backend supports using [customer-supplied](/terraform/language/backend/gcs#customer-supplied-encryption-keys) or [customer-managed (Cloud KMS)](/terraform/language/backend/gcs#customer-managed-encryption-keys-cloud-kms) encryption keys.
